
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>GALAHAD BQP package &#8212; GALAHAD Julia interfaces 1.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/doxyrest-pygments.css?v=ff3f4257" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=a6bbf7ec" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=56dcb7b8"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/target-highlight.js?v=df7d332b"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'bqp';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="callable functions" href="bqp_functions.html" />
    <link rel="prev" title="Quadratic Programming" href="qp.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/galahad.small.png" class="logo__image only-light" alt="GALAHAD Julia interfaces 1.1 documentation - Home"/>
    <img src="_static/galahad.small.png" class="logo__image only-dark pst-js-only" alt="GALAHAD Julia interfaces 1.1 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="uco.html">
    Unconstrained Optimization
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="bco.html">
    Bound-constrained Optimization
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="ls.html">
    Least-Squares
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="lp.html">
    Linear Programming
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="qp.html">
    Quadratic Programming
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="reg.html">
    Regularization subproblems
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="sys.html">
    Linear Systems
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="go.html">
    Global Optimization
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="auxiliary.html">
    Auxiliary Procedures
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="uco.html">
    Unconstrained Optimization
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="bco.html">
    Bound-constrained Optimization
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="ls.html">
    Least-Squares
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="lp.html">
    Linear Programming
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="qp.html">
    Quadratic Programming
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="reg.html">
    Regularization subproblems
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="sys.html">
    Linear Systems
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="go.html">
    Global Optimization
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="auxiliary.html">
    Auxiliary Procedures
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">BQP - bound-constrained quadratic programming using a preconditioned, projected-gradient method</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="bqp_functions.html">callable functions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="bqpb.html">BQPB - bound-constrained quadratic programming using an interior-point method</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="bqpb_functions.html">callable functions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="cqp.html">CQP - convex quadratic programming using an interior-point method</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="cqp_functions.html">callable functions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="cro.html">CRO - crossover from an interior-point to basic solution for convex quadratic programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="cro_functions.html">callable functions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="dqp.html">DQP - convex quadratic programming using a dual active-set method</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="dqp_functions.html">callable functions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="eqp.html">EQP - equality-constrained quadratic programming using an iterative method</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="eqp_functions.html">callable functions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lsqp.html">LSQP - linear or separable convex quadratic programming using an interior-point trust-region method</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="lsqp_functions.html">callable functions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="qpa.html">QPA - non-convex quadratic programming using an active-set method</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="qpa_functions.html">callable functions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="qpb.html">QPB - non-convex quadratic programming using an interior-point method</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="qpb_functions.html">callable functions</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="qp.html" class="nav-link">Quadratic Programming</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">GALAHAD BQP package</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-galahad.bqp">
<span id="galahad-bqp-package"></span><span id="doxid-index-bqp"></span><h1>GALAHAD BQP package<a class="headerlink" href="#module-galahad.bqp" title="Link to this heading">#</a></h1>
<section id="purpose">
<h2>purpose<a class="headerlink" href="#purpose" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">bqp</span></code> package uses a <strong>preconditioned, projected-gradient method</strong> to
solve a given <strong>bound-constrained convex quadratic program</strong>.
The aim is to minimize the quadratic objective function
<div class="math notranslate nohighlight">
\[q(x) = f + g^T x + \frac{1}{2} x^T H x,\]</div>

subject to the simple bounds
<div class="math notranslate nohighlight">
\[x_l \leq x \leq x_u,\]</div>

where <span class="math notranslate nohighlight">\(H\)</span> is a given <span class="math notranslate nohighlight">\(n\)</span> by <span class="math notranslate nohighlight">\(n\)</span> symmetric postive-semi-definite matrix,
<span class="math notranslate nohighlight">\(g\)</span> is a vector, <span class="math notranslate nohighlight">\(f\)</span> is a scalar, and any of the components
of the vectors <span class="math notranslate nohighlight">\(x_l\)</span> or <span class="math notranslate nohighlight">\(x_u\)</span> may be infinite.
The method offers the choice of direct and iterative solution of the key
regularization subproblems, and is most suitable for problems
involving a large number of unknowns <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>See Section 4 of $GALAHAD/doc/bqp.pdf for a brief description of the
method employed and other details.</p>
</section>
<section id="terminology">
<h2>terminology<a class="headerlink" href="#terminology" title="Link to this heading">#</a></h2>
<p>Any required solution <span class="math notranslate nohighlight">\(x\)</span> necessarily satisfies
the <strong>primal optimality conditions</strong>
<div class="math notranslate nohighlight">
\[x_l \leq x \leq x_u,\]</div>

the <strong>dual optimality conditions</strong>
<div class="math notranslate nohighlight">
\[H x + g = z, \;\; z = z_l + z_u, z_l \geq 0 \;\;\mbox{and}\;\; z_u \leq 0,\]</div>

and the <strong>complementary slackness conditions</strong>
<div class="math notranslate nohighlight">
\[(x -x_l )^{T} z_l = 0 \;\;\mbox{and}\;\;(x -x_u )^{T} z_u = 0,\]</div>

where the vector <span class="math notranslate nohighlight">\(z\)</span> is known as the <strong>dual variables</strong> for the bounds,
and where the vector inequalities hold component-wise.</p>
</section>
<section id="method">
<h2>method<a class="headerlink" href="#method" title="Link to this heading">#</a></h2>
<p>Projected-gradient methods iterate towards a point
that satisfies these conditions by ultimately aiming to satisfy
<span class="math notranslate nohighlight">\(H x + g = z\)</span> and <span class="math notranslate nohighlight">\(z = z_l + z_u\)</span>, while satifying the remaining
optimality conditions at each stage. Appropriate norms of the amounts by
which the optimality conditions fail to be satisfied are known as the
primal and dual infeasibility, and the violation of complementary slackness,
respectively.</p>
<p>The method is iterative. Each iteration proceeds in two stages.
Firstly, the so-called generalized Cauchy point for the quadratic
objective is found.  (The purpose of this point is to ensure that the
algorithm converges and that the set of bounds which are satisfied as
equations at the solution is rapidly identified.)  Thereafter an
improvement to the objective is sought using either a
direct-matrix or truncated conjugate-gradient algorithm.</p>
</section>
<section id="reference">
<h2>reference<a class="headerlink" href="#reference" title="Link to this heading">#</a></h2>
<p>This is a specialised version of the method presented in</p>
<blockquote>
<div><p>A. R. Conn, N. I. M. Gould and Ph. L. Toint,
Global convergence of a class of trust region algorithms
for optimization with simple bounds.
<em>SIAM Journal on Numerical Analysis</em> <strong>25</strong> (1988) 433-460.</p>
</div></blockquote>
</section>
<section id="matrix-storage">
<span id="details-h-storage-sym"></span><span id="details-h-storage"></span><h2>matrix storage<a class="headerlink" href="#matrix-storage" title="Link to this heading">#</a></h2>
<p>The <strong>symmetric</strong> <span class="math notranslate nohighlight">\(n\)</span> by <span class="math notranslate nohighlight">\(n\)</span> matrix <span class="math notranslate nohighlight">\(H\)</span> may
be presented and stored in a variety of formats. But crucially symmetry
is exploited by only storing values from the <em>lower triangular</em> part
(i.e, those entries that lie on or below the leading diagonal).</p>
<p><em>Dense</em> storage format:
The matrix <span class="math notranslate nohighlight">\(H\)</span> is stored as a compact  dense matrix by rows, that
is, the values of the entries of each row in turn are stored in order
within an appropriate real one-dimensional array. Since <span class="math notranslate nohighlight">\(H\)</span> is
symmetric, only the lower triangular part (that is the part
<span class="math notranslate nohighlight">\(H_{ij}\)</span> for <span class="math notranslate nohighlight">\(1 \leq j \leq i \leq n\)</span>) need be held.
In this case the lower triangle should be stored by rows, that is
component <span class="math notranslate nohighlight">\((i-1) * i / 2 + j\)</span>  of the storage array H_val
will hold the value <span class="math notranslate nohighlight">\(H_{ij}\)</span> (and, by symmetry, <span class="math notranslate nohighlight">\(H_{ji}\)</span>)
for <span class="math notranslate nohighlight">\(1 \leq j \leq i \leq n\)</span>.
The string H_type = ‘dense’ should be specified.</p>
<p><em>Sparse co-ordinate</em> storage format:
Only the nonzero entries of the matrices are stored.
For the <span class="math notranslate nohighlight">\(l\)</span>-th entry, <span class="math notranslate nohighlight">\(1 \leq l \leq ne\)</span>, of <span class="math notranslate nohighlight">\(H\)</span>,
its row index i, column index j and value <span class="math notranslate nohighlight">\(H_{ij}\)</span>,
<span class="math notranslate nohighlight">\(1 \leq j \leq i \leq n\)</span>,  are stored as the <span class="math notranslate nohighlight">\(l\)</span>-th
components of the integer arrays H_row and H_col and real array H_val,
respectively, while the number of nonzeros is recorded as H_ne = <span class="math notranslate nohighlight">\(ne\)</span>.
Note that only the entries in the lower triangle should be stored.
The string H_type = ‘coordinate’ should be specified.</p>
<p><em>Sparse row-wise</em> storage format:
Again only the nonzero entries are stored, but this time
they are ordered so that those in row i appear directly before those
in row i+1. For the i-th row of <span class="math notranslate nohighlight">\(H\)</span> the i-th component of the
integer array H_ptr holds the position of the first entry in this row,
while H_ptr(n+1) holds the total number of entries plus one.
The column indices j, <span class="math notranslate nohighlight">\(1 \leq j \leq i\)</span>, and values <span class="math notranslate nohighlight">\(H_{ij}\)</span> of the entries
in the i-th row are stored in components l = H_ptr(i), …, H_ptr(i+1)-1 of the
integer array H_col, and real array H_val, respectively. Note that as before
only the entries in the lower triangle should be stored. For sparse matrices,
this scheme almost always requires less storage than its predecessor.
The string H_type = ‘sparse_by_rows’ should be specified.</p>
<p><em>Diagonal</em> storage format:
If <span class="math notranslate nohighlight">\(H\)</span> is diagonal (i.e., <span class="math notranslate nohighlight">\(H_{ij} = 0\)</span> for all
<span class="math notranslate nohighlight">\(1 \leq i \neq j \leq n\)</span>) only the diagonals entries
<span class="math notranslate nohighlight">\(H_{ii}\)</span>, <span class="math notranslate nohighlight">\(1 \leq i \leq n\)</span> need be stored,
and the first n components of the array H_val may be used for the purpose.
The string H_type = ‘diagonal’ should be specified.</p>
<p><em>Multiples of the identity</em> storage format:
If <span class="math notranslate nohighlight">\(H\)</span> is a multiple of the identity matrix, (i.e., <span class="math notranslate nohighlight">\(H = \alpha I\)</span>
where <span class="math notranslate nohighlight">\(I\)</span> is the n by n identity matrix and <span class="math notranslate nohighlight">\(\alpha\)</span> is a scalar),
it suffices to store <span class="math notranslate nohighlight">\(\alpha\)</span> as the first component of H_val.
The string H_type = ‘scaled_identity’ should be specified.</p>
<p>The <em>identity matrix</em> format:
If <span class="math notranslate nohighlight">\(H\)</span> is the identity matrix, no values need be stored.
The string H_type = ‘identity’ should be specified.</p>
<p>The <em>zero matrix</em> format:
The same is true if <span class="math notranslate nohighlight">\(H\)</span> is the zero matrix, but now
the string H_type = ‘zero’ or ‘none’ should be specified.</p>
<div class="toctree-wrapper compound">
</div>
</section>
<section id="introduction-to-function-calls">
<h2>introduction to function calls<a class="headerlink" href="#introduction-to-function-calls" title="Link to this heading">#</a></h2>
<p>To solve a given problem, functions from the bqp package must be
called in the following order:</p>
<ul class="simple">
<li><p><a class="reference internal" href="bqp_functions.html#doxid-galahad-bqp-8h-1a4466621895dd2314f1b3c21b4bc7f615"><span class="std std-ref">bqp_initialize</span></a> - provide default control parameters and set up initial data structures</p></li>
<li><p><a class="reference internal" href="bqp_functions.html#doxid-galahad-bqp-8h-1a0e3ffdd29be95753292694c7619a43e6"><span class="std std-ref">bqp_read_specfile</span></a> (optional) - override control values by reading replacement values from a file</p></li>
<li><p>set up problem data structures and fixed values by caling one of</p>
<ul>
<li><p><a class="reference internal" href="bqp_functions.html#doxid-galahad-bqp-8h-1a0cfa65e832fd80e3dfcf9e0c65a69e56"><span class="std std-ref">bqp_import</span></a> - in the case that <span class="math notranslate nohighlight">\(H\)</span> is explicitly available</p></li>
<li><p><a class="reference internal" href="bqp_functions.html#doxid-galahad-bqp-8h-1a9a99d880b3bfbcfb7b093756019c5f0e"><span class="std std-ref">bqp_import_without_h</span></a> - in the case that only the effect of applying <span class="math notranslate nohighlight">\(H\)</span> to a vector is possible</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="bqp_functions.html#doxid-galahad-bqp-8h-1a315ce83042f67a466cfdd868c27a2850"><span class="std std-ref">bqp_reset_control</span></a> (optional) - possibly change control parameters if a sequence of problems are being solved</p></li>
<li><p>solve the problem by calling one of</p>
<ul>
<li><p><a class="reference internal" href="bqp_functions.html#doxid-galahad-bqp-8h-1acb5ad644890efe38b7cf7048d6297308"><span class="std std-ref">bqp_solve_given_h</span></a> - solve the problem using values of <span class="math notranslate nohighlight">\(H\)</span></p></li>
<li><p><a class="reference internal" href="bqp_functions.html#doxid-galahad-bqp-8h-1a116b9b4ff28b9e2d18be0f0900ce2755"><span class="std std-ref">bqp_solve_reverse_h_prod</span></a> - solve the problem by returning to the caller for products of <span class="math notranslate nohighlight">\(H\)</span> with specified vectors</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="bqp_functions.html#doxid-galahad-bqp-8h-1a75b662635f281148e9c19e12e0788362"><span class="std std-ref">bqp_information</span></a> (optional) - recover information about the solution and solution process</p></li>
<li><p><a class="reference internal" href="bqp_functions.html#doxid-galahad-bqp-8h-1a34db499197d1fd6fb78b294473796fbc"><span class="std std-ref">bqp_terminate</span></a> - deallocate data structures</p></li>
</ul>
<p>See the <a class="reference internal" href="#doxid-index-bqp-examples"><span class="std std-ref">examples</span></a> section for
illustrations of use.</p>
</section>
<section id="parametric-real-type-t-and-integer-type-int">
<span id="details-t-and-int-types"></span><h2>parametric real type T and integer type INT<a class="headerlink" href="#parametric-real-type-t-and-integer-type-int" title="Link to this heading">#</a></h2>
<p>Below, the symbol T refers to a parametric real type that may be Float32
(single precision), Float64 (double precision) or, if supported, Float128
(quadruple precision). The symbol INT refers to a parametric integer type
that may be Int32 (32-bit integer) or Int64 (64-bit integer).</p>
</section>
<section id="callable-functions">
<h2>callable functions<a class="headerlink" href="#callable-functions" title="Link to this heading">#</a></h2>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-bqp-8h-1a4466621895dd2314f1b3c21b4bc7f615"><span id="index-0"></span><span></span><span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">bqp_initialize</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">INT</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">control</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">)</span></pre>
<p>Set default control values and initialize private data</p>
<p class="rubric">Parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>control</p></td>
<td><p>is a structure containing control information (see <a class="reference internal" href="struct_bqp_control_type.html#doxid-structbqp-control-type"><span class="std std-ref">bqp_control_type</span></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>is a scalar variable of type INT that gives the exit status from the package. Possible values are (currently):</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>0</strong></dt><dd><p>The initialization was successful.</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-bqp-8h-1a0e3ffdd29be95753292694c7619a43e6"><span id="index-1"></span><span></span><span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">bqp_read_specfile</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">INT</span><span class="p">,</span><span class="w"> </span><span class="n">control</span><span class="p">,</span><span class="w"> </span><span class="n">specfile</span><span class="p">)</span></pre>
<p>Read the content of a specification file, and assign values associated
with given keywords to the corresponding control parameters.  An
in-depth discussion of specification files is
<a class="reference internal" href="spec.html#details-spec-file"><span class="std std-ref">available</span></a>, and a detailed list of keywords
with associated default values is provided in
$GALAHAD/src/bqp/BQP.template.  See also Table 2.1 in the Fortran
documentation provided in $GALAHAD/doc/bqp.pdf for a list of how these
keywords relate to the components of the control structure.</p>
<p class="rubric">Parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>control</p></td>
<td><p>is a structure containing control information (see <a class="reference internal" href="struct_bqp_control_type.html#doxid-structbqp-control-type"><span class="std std-ref">bqp_control_type</span></a>)</p></td>
</tr>
<tr class="row-even"><td><p>specfile</p></td>
<td><p>is a one-dimensional array of type Vararg{Cchar} that must give the name of the specification file</p></td>
</tr>
</tbody>
</table>
</div>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-bqp-8h-1a0cfa65e832fd80e3dfcf9e0c65a69e56"><span id="index-2"></span><span></span><span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">bqp_import</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">INT</span><span class="p">,</span><span class="w"> </span><span class="n">control</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">H_type</span><span class="p">,</span><span class="w"> </span><span class="n">ne</span><span class="p">,</span>
<span class="w">                        </span><span class="n">H_row</span><span class="p">,</span><span class="w"> </span><span class="n">H_col</span><span class="p">,</span><span class="w"> </span><span class="n">H_ptr</span><span class="p">)</span></pre>
<p>Import problem data into internal storage prior to solution.</p>
<p class="rubric">Parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>control</p></td>
<td><p>is a structure whose members provide control parameters for the remaining procedures (see <a class="reference internal" href="struct_bqp_control_type.html#doxid-structbqp-control-type"><span class="std std-ref">bqp_control_type</span></a>)</p></td>
</tr>
<tr class="row-even"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>is a scalar variable of type INT that gives the exit
status from the package. Possible values are:</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>1</strong></dt><dd><p>The import was successful, and the package is ready
for the solve phase</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-1</strong></dt><dd><p>An allocation error occurred. A message indicating
the offending array is written on unit
control.error, and the returned allocation status
and a string containing the name of the offending
array are held in inform.alloc_status and
inform.bad_alloc respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-2</strong></dt><dd><p>A deallocation error occurred. A message indicating
the offending array is written on unit control.error
and the returned allocation status and a string
containing the name of the offending array are held
in inform.alloc_status and inform.bad_alloc
respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-3</strong></dt><dd><p>The restriction n &gt; 0 or requirement that type
contains its relevant string ‘dense’, ‘coordinate’,
‘sparse_by_rows’ or ‘diagonal’ has been violated.</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>n</p></td>
<td><p>is a scalar variable of type INT that holds the number of variables.</p></td>
</tr>
<tr class="row-odd"><td><p>H_type</p></td>
<td><p>is a one-dimensional array of type Vararg{Cchar} that specifies the <a class="reference internal" href="bqpb.html#details-h-storage-sym"><span class="std std-ref">symmetric storage scheme</span></a> used for the Hessian. It should be one of ‘coordinate’, ‘sparse_by_rows’, ‘dense’, ‘diagonal’ or ‘absent’, the latter if access to the Hessian is via matrix-vector products; lower or upper case variants are allowed.</p></td>
</tr>
<tr class="row-even"><td><p>ne</p></td>
<td><p>is a scalar variable of type INT that holds the number of entries in the lower triangular part of H in the sparse co-ordinate storage scheme. It need not be set for any of the other three schemes.</p></td>
</tr>
<tr class="row-odd"><td><p>H_row</p></td>
<td><p>is a one-dimensional array of size ne and type INT that holds the row indices of the lower triangular part of H in the sparse co-ordinate storage scheme. It need not be set for any of the other three schemes, and in this case can be C_NULL</p></td>
</tr>
<tr class="row-even"><td><p>H_col</p></td>
<td><p>is a one-dimensional array of size ne and type INT that holds the column indices of the lower triangular part of H in either the sparse co-ordinate, or the sparse row-wise storage scheme. It need not be set when the dense or diagonal storage schemes are used, and in this case can be C_NULL</p></td>
</tr>
<tr class="row-odd"><td><p>H_ptr</p></td>
<td><p>is a one-dimensional array of size n+1 and type INT that holds the starting position of each row of the lower triangular part of H, as well as the total number of entries, in the sparse row-wise storage scheme. It need not be set when the other schemes are used, and in this case can be C_NULL</p></td>
</tr>
</tbody>
</table>
</div>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-bqp-8h-1a9a99d880b3bfbcfb7b093756019c5f0e"><span id="index-3"></span><span></span><span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">bqp_import_without_h</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">INT</span><span class="p">,</span><span class="w"> </span><span class="n">control</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span></pre>
<p>Import problem data into internal storage prior to solution.</p>
<p class="rubric">Parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>control</p></td>
<td><p>is a structure whose members provide control parameters for the remaining procedures (see <a class="reference internal" href="struct_bqp_control_type.html#doxid-structbqp-control-type"><span class="std std-ref">bqp_control_type</span></a>)</p></td>
</tr>
<tr class="row-even"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>is a scalar variable of type INT that gives the exit
status from the package. Possible values are:</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>1</strong></dt><dd><p>The import was successful, and the package is ready
for the solve phase</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-1</strong></dt><dd><p>An allocation error occurred. A message indicating
the offending array is written on unit
control.error, and the returned allocation status
and a string containing the name of the offending
array are held in inform.alloc_status and
inform.bad_alloc respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-2</strong></dt><dd><p>A deallocation error occurred. A message indicating
the offending array is written on unit control.error
and the returned allocation status and a string
containing the name of the offending array are held
in inform.alloc_status and inform.bad_alloc
respectively.</p>
</dd>
</dl>
</li>
<li><p>-3. The restriction n &gt; 0 has been violated.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>n</p></td>
<td><p>is a scalar variable of type INT that holds the number of variables.</p></td>
</tr>
</tbody>
</table>
</div>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-bqp-8h-1a315ce83042f67a466cfdd868c27a2850"><span id="index-4"></span><span></span><span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">bqp_reset_control</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">INT</span><span class="p">,</span><span class="w"> </span><span class="n">control</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">)</span></pre>
<p>Reset control parameters after import if required.</p>
<p class="rubric">Parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>control</p></td>
<td><p>is a structure whose members provide control parameters for the remaining procedures (see <a class="reference internal" href="struct_bqp_control_type.html#doxid-structbqp-control-type"><span class="std std-ref">bqp_control_type</span></a>)</p></td>
</tr>
<tr class="row-even"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>is a scalar variable of type INT that gives the exit
status from the package. Possible values are:</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>1</strong></dt><dd><p>The import was successful, and the package is ready
for the solve phase</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-bqp-8h-1acb5ad644890efe38b7cf7048d6297308"><span id="index-5"></span><span></span><span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">bqp_solve_given_h</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">INT</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">h_ne</span><span class="p">,</span><span class="w"> </span><span class="n">H_val</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span>
<span class="w">                               </span><span class="n">x_l</span><span class="p">,</span><span class="w"> </span><span class="n">x_u</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">x_stat</span><span class="p">)</span></pre>
<p>Solve the bound-constrained quadratic program when the Hessian <span class="math notranslate nohighlight">\(H\)</span> is available.</p>
<p class="rubric">Parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>status</p></td>
<td><p>is a scalar variable of type INT that gives the
entry and exit status from the package.</p>
<p>On initial entry, status must be set to 1.</p>
<p>Possible exit values are:</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>0</strong></dt><dd><p>The run was successful.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-1</strong></dt><dd><p>An allocation error occurred. A message indicating
the offending array is written on unit
control.error, and the returned allocation status
and a string containing the name of the offending
array are held in inform.alloc_status and
inform.bad_alloc respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-2</strong></dt><dd><p>A deallocation error occurred. A message indicating
the offending array is written on unit control.error
and the returned allocation status and a string
containing the name of the offending array are held
in inform.alloc_status and inform.bad_alloc
respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-3</strong></dt><dd><p>The restriction n &gt; 0 or requirement that a type
contains its relevant string ‘dense’, ‘coordinate’,
‘sparse_by_rows’ or ‘diagonal’ has been violated.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-4</strong></dt><dd><p>The simple-bound constraints are inconsistent.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-9</strong></dt><dd><p>The analysis phase of the factorization failed; the
return status from the factorization package is
given in the component inform.factor_status</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-10</strong></dt><dd><p>The factorization failed; the return status from the
factorization package is given in the component
inform.factor_status.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-11</strong></dt><dd><p>The solution of a set of linear equations using
factors from the factorization package failed; the
return status from the factorization package is
given in the component inform.factor_status.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-16</strong></dt><dd><p>The problem is so ill-conditioned that further
progress is impossible.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-17</strong></dt><dd><p>The step is too small to make further impact.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-18</strong></dt><dd><p>Too many iterations have been performed. This may
happen if control.maxit is too small, but may also
be symptomatic of a badly scaled problem.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-19</strong></dt><dd><p>The CPU time limit has been reached. This may happen
if control.cpu_time_limit is too small, but may also
be symptomatic of a badly scaled problem.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-20</strong></dt><dd><p>The Hessian matrix <span class="math notranslate nohighlight">\(H\)</span> appears to be
indefinite. specified.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-23</strong></dt><dd><p>An entry from the strict upper triangle of <span class="math notranslate nohighlight">\(H\)</span> has
been</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>n</p></td>
<td><p>is a scalar variable of type INT that holds the number of variables</p></td>
</tr>
<tr class="row-even"><td><p>h_ne</p></td>
<td><p>is a scalar variable of type INT that holds the number of entries in the lower triangular part of the Hessian matrix <span class="math notranslate nohighlight">\(H\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>H_val</p></td>
<td><p>is a one-dimensional array of size h_ne and type T that holds the values of the entries of the lower triangular part of the Hessian matrix <span class="math notranslate nohighlight">\(H\)</span> in any of the available storage schemes.</p></td>
</tr>
<tr class="row-even"><td><p>g</p></td>
<td><p>is a one-dimensional array of size n and type T that holds the linear term <span class="math notranslate nohighlight">\(g\)</span> of the objective function. The j-th component of <code class="docutils literal notranslate"><span class="pre">g</span></code>, j = 1, … , n, contains <span class="math notranslate nohighlight">\(g_j\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>f</p></td>
<td><p>is a scalar of type T that holds the constant term <span class="math notranslate nohighlight">\(f\)</span> of the objective function.</p></td>
</tr>
<tr class="row-even"><td><p>x_l</p></td>
<td><p>is a one-dimensional array of size n and type T that holds the lower bounds <span class="math notranslate nohighlight">\(x^l\)</span> on the variables <span class="math notranslate nohighlight">\(x\)</span>. The j-th component of <code class="docutils literal notranslate"><span class="pre">x_l</span></code>, j = 1, … , n, contains <span class="math notranslate nohighlight">\(x^l_j\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>x_u</p></td>
<td><p>is a one-dimensional array of size n and type T that holds the upper bounds <span class="math notranslate nohighlight">\(x^l\)</span> on the variables <span class="math notranslate nohighlight">\(x\)</span>. The j-th component of <code class="docutils literal notranslate"><span class="pre">x_u</span></code>, j = 1, … , n, contains <span class="math notranslate nohighlight">\(x^l_j\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p>x</p></td>
<td><p>is a one-dimensional array of size n and type T that holds the values <span class="math notranslate nohighlight">\(x\)</span> of the optimization variables. The j-th component of <code class="docutils literal notranslate"><span class="pre">x</span></code>, j = 1, … , n, contains <span class="math notranslate nohighlight">\(x_j\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>z</p></td>
<td><p>is a one-dimensional array of size n and type T that holds the values <span class="math notranslate nohighlight">\(z\)</span> of the dual variables. The j-th component of <code class="docutils literal notranslate"><span class="pre">z</span></code>, j = 1, … , n, contains <span class="math notranslate nohighlight">\(z_j\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p>x_stat</p></td>
<td><p>is a one-dimensional array of size n and type INT that gives the optimal status of the problem variables. If x_stat(j) is negative, the variable <span class="math notranslate nohighlight">\(x_j\)</span> most likely lies on its lower bound, if it is positive, it lies on its upper bound, and if it is zero, it lies between its bounds.</p></td>
</tr>
</tbody>
</table>
</div>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-bqp-8h-1a116b9b4ff28b9e2d18be0f0900ce2755"><span id="index-6"></span><span></span><span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">bqp_solve_reverse_h_prod</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">INT</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span>
<span class="w">                                      </span><span class="n">x_l</span><span class="p">,</span><span class="w"> </span><span class="n">x_u</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">x_stat</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span>
<span class="w">                                      </span><span class="n">prod</span><span class="p">,</span><span class="w"> </span><span class="n">nz_v</span><span class="p">,</span><span class="w"> </span><span class="n">nz_v_start</span><span class="p">,</span>
<span class="w">                                      </span><span class="n">nz_v_end</span><span class="p">,</span><span class="w"> </span><span class="n">nz_prod</span><span class="p">,</span><span class="w"> </span><span class="n">nz_prod_end</span><span class="p">)</span></pre>
<p>Solve the bound-constrained quadratic program when the products of the
Hessian <span class="math notranslate nohighlight">\(H\)</span> with specified vectors may be computed by the calling
program.</p>
<p class="rubric">Parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>status</p></td>
<td><p>is a scalar variable of type INT that gives the
entry and exit status from the package.</p>
<p>Possible exit values are:</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>0</strong></dt><dd><p>The run was successful.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-1</strong></dt><dd><p>An allocation error occurred. A message indicating
the offending array is written on unit
control.error, and the returned allocation status
and a string containing the name of the offending
array are held in inform.alloc_status and
inform.bad_alloc respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-2</strong></dt><dd><p>A deallocation error occurred. A message indicating
the offending array is written on unit control.error
and the returned allocation status and a string
containing the name of the offending array are held
in inform.alloc_status and inform.bad_alloc
respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-3</strong></dt><dd><p>The restriction n &gt; 0 or requirement that a type
contains its relevant string ‘dense’, ‘coordinate’,
‘sparse_by_rows’ or ‘diagonal’ has been violated.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-4</strong></dt><dd><p>The simple-bound constraints are inconsistent.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-9</strong></dt><dd><p>The analysis phase of the factorization failed; the
return status from the factorization package is
given in the component inform.factor_status</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-10</strong></dt><dd><p>The factorization failed; the return status from the
factorization package is given in the component
inform.factor_status.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-11</strong></dt><dd><p>The solution of a set of linear equations using
factors from the factorization package failed; the
return status from the factorization package is
given in the component inform.factor_status.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-16</strong></dt><dd><p>The problem is so ill-conditioned that further
progress is impossible.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-17</strong></dt><dd><p>The step is too small to make further impact.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-18</strong></dt><dd><p>Too many iterations have been performed. This may
happen if control.maxit is too small, but may also
be symptomatic of a badly scaled problem.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-19</strong></dt><dd><p>The CPU time limit has been reached. This may happen
if control.cpu_time_limit is too small, but may also
be symptomatic of a badly scaled problem.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-20</strong></dt><dd><p>The Hessian matrix <span class="math notranslate nohighlight">\(H\)</span> appears to be
indefinite. specified.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-23</strong></dt><dd><p>An entry from the strict upper triangle of <span class="math notranslate nohighlight">\(H\)</span> has
been specified.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>2</strong></dt><dd><p>The product <span class="math notranslate nohighlight">\(Hv\)</span> of the Hessian <span class="math notranslate nohighlight">\(H\)</span> with a given
output vector <span class="math notranslate nohighlight">\(v\)</span> is required from the user. The
vector <span class="math notranslate nohighlight">\(v\)</span> will be stored in v and the product <span class="math notranslate nohighlight">\(Hv\)</span>
must be returned in prod, and
bqp_solve_reverse_h_prod re-entered with all other
arguments unchanged.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>3</strong></dt><dd><p>The product <span class="math notranslate nohighlight">\(Hv\)</span> of the Hessian H with a given
output vector <span class="math notranslate nohighlight">\(v\)</span> is required from the user. Only
components nz_v[nz_v_start-1:nz_v_end-1] of the
vector <span class="math notranslate nohighlight">\(v\)</span> stored in v are nonzero. The resulting
product <span class="math notranslate nohighlight">\(Hv\)</span> must be placed in prod, and
bqp_solve_reverse_h_prod re-entered with all other
arguments unchanged.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>4</strong></dt><dd><p>The product <span class="math notranslate nohighlight">\(Hv\)</span> of the Hessian H with a given
output vector <span class="math notranslate nohighlight">\(v\)</span> is required from the user. Only
components nz_v[nz_v_start-1:nz_v_end-1] of the
vector <span class="math notranslate nohighlight">\(v\)</span> stored in v are nonzero. The resulting
<strong>nonzeros</strong> in the product <span class="math notranslate nohighlight">\(Hv\)</span> must be placed in
their appropriate comnponents of prod, while a list
of indices of the nonzeros placed in nz_prod[0 :
nz_prod_end-1]. bqp_solve_reverse_h_prod should then
be re-entered with all other arguments
unchanged. Typically v will be very sparse (i.e.,
nz_p_end-nz_p_start will be small).</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>n</p></td>
<td><p>is a scalar variable of type INT that holds the number of variables</p></td>
</tr>
<tr class="row-even"><td><p>g</p></td>
<td><p>is a one-dimensional array of size n and type T that holds the linear term <span class="math notranslate nohighlight">\(g\)</span> of the objective function. The j-th component of <code class="docutils literal notranslate"><span class="pre">g</span></code>, j = 1, … , n, contains <span class="math notranslate nohighlight">\(g_j\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>f</p></td>
<td><p>is a scalar of type T that holds the constant term <span class="math notranslate nohighlight">\(f\)</span> of the objective function.</p></td>
</tr>
<tr class="row-even"><td><p>x_l</p></td>
<td><p>is a one-dimensional array of size n and type T that holds the lower bounds <span class="math notranslate nohighlight">\(x^l\)</span> on the variables <span class="math notranslate nohighlight">\(x\)</span>. The j-th component of <code class="docutils literal notranslate"><span class="pre">x_l</span></code>, j = 1, … , n, contains <span class="math notranslate nohighlight">\(x^l_j\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>x_u</p></td>
<td><p>is a one-dimensional array of size n and type T that holds the upper bounds <span class="math notranslate nohighlight">\(x^l\)</span> on the variables <span class="math notranslate nohighlight">\(x\)</span>. The j-th component of <code class="docutils literal notranslate"><span class="pre">x_u</span></code>, j = 1, … , n, contains <span class="math notranslate nohighlight">\(x^l_j\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p>x</p></td>
<td><p>is a one-dimensional array of size n and type T that holds the values <span class="math notranslate nohighlight">\(x\)</span> of the optimization variables. The j-th component of <code class="docutils literal notranslate"><span class="pre">x</span></code>, j = 1, … , n, contains <span class="math notranslate nohighlight">\(x_j\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>z</p></td>
<td><p>is a one-dimensional array of size n and type T that holds the values <span class="math notranslate nohighlight">\(z\)</span> of the dual variables. The j-th component of <code class="docutils literal notranslate"><span class="pre">z</span></code>, j = 1, … , n, contains <span class="math notranslate nohighlight">\(z_j\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p>x_stat</p></td>
<td><p>is a one-dimensional array of size n and type INT that gives the optimal status of the problem variables. If x_stat(j) is negative, the variable <span class="math notranslate nohighlight">\(x_j\)</span> most likely lies on its lower bound, if it is positive, it lies on its upper bound, and if it is zero, it lies between its bounds.</p></td>
</tr>
<tr class="row-odd"><td><p>v</p></td>
<td><p>is a one-dimensional array of size n and type T that is used for reverse communication (see status=2-4 above for details)</p></td>
</tr>
<tr class="row-even"><td><p>prod</p></td>
<td><p>is a one-dimensional array of size n and type T that is used for reverse communication (see status=2-4 above for details)</p></td>
</tr>
<tr class="row-odd"><td><p>nz_v</p></td>
<td><p>is a one-dimensional array of size n and type INT that is used for reverse communication (see status=3-4 above for details)</p></td>
</tr>
<tr class="row-even"><td><p>nz_v_start</p></td>
<td><p>is a scalar of type INT that is used for reverse communication (see status=3-4 above for details)</p></td>
</tr>
<tr class="row-odd"><td><p>nz_v_end</p></td>
<td><p>is a scalar of type INT that is used for reverse communication (see status=3-4 above for details)</p></td>
</tr>
<tr class="row-even"><td><p>nz_prod</p></td>
<td><p>is a one-dimensional array of size n and type INT that is used for reverse communication (see status=4 above for details)</p></td>
</tr>
<tr class="row-odd"><td><p>nz_prod_end</p></td>
<td><p>is a scalar of type INT that is used for reverse communication (see status=4 above for details)</p></td>
</tr>
</tbody>
</table>
</div>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-bqp-8h-1a75b662635f281148e9c19e12e0788362"><span id="index-7"></span><span></span><span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">bqp_information</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">INT</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">inform</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">)</span></pre>
<p>Provides output information</p>
<p class="rubric">Parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>inform</p></td>
<td><p>is a structure containing output information (see <a class="reference internal" href="struct_bqp_inform_type.html#doxid-structbqp-inform-type"><span class="std std-ref">bqp_inform_type</span></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>is a scalar variable of type INT that gives the exit
status from the package. Possible values are
(currently):</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>0</strong></dt><dd><p>The values were recorded successfully</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-bqp-8h-1a34db499197d1fd6fb78b294473796fbc"><span id="index-8"></span><span></span><span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">bqp_terminate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">INT</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">control</span><span class="p">,</span><span class="w"> </span><span class="n">inform</span><span class="p">)</span></pre>
<p>Deallocate all internal private storage</p>
<p class="rubric">Parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>control</p></td>
<td><p>is a structure containing control information (see <a class="reference internal" href="struct_bqp_control_type.html#doxid-structbqp-control-type"><span class="std std-ref">bqp_control_type</span></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>inform</p></td>
<td><p>is a structure containing output information (see <a class="reference internal" href="struct_bqp_inform_type.html#doxid-structbqp-inform-type"><span class="std std-ref">bqp_inform_type</span></a>)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="available-structures">
<h2>available structures<a class="headerlink" href="#available-structures" title="Link to this heading">#</a></h2>
</section>
<section id="bqp-control-type-structure">
<span id="doxid-structbqp-control-type"></span><span id="index-9"></span><h2>bqp_control_type structure<a class="headerlink" href="#bqp-control-type-structure" title="Link to this heading">#</a></h2>
<div class="toctree-wrapper compound">
</div>
<pre class="highlight doxyrest-overview-code-block literal-block"><span></span><span class="w">    </span><span class="k">struct</span> <span class="kt">bqp_control_type</span><span class="p">{</span><span class="kt">T</span><span class="p">,</span><span class="kt">INT</span><span class="p">}</span>
<span class="w">      </span><span class="n">f_indexing</span><span class="o">::</span><span class="kt">Bool</span>
<span class="w">      </span><span class="n">error</span><span class="o">::</span><span class="kt">INT</span>
<span class="w">      </span><span class="n">out</span><span class="o">::</span><span class="kt">INT</span>
<span class="w">      </span><span class="n">print_level</span><span class="o">::</span><span class="kt">INT</span>
<span class="w">      </span><span class="n">start_print</span><span class="o">::</span><span class="kt">INT</span>
<span class="w">      </span><span class="n">stop_print</span><span class="o">::</span><span class="kt">INT</span>
<span class="w">      </span><span class="n">print_gap</span><span class="o">::</span><span class="kt">INT</span>
<span class="w">      </span><span class="n">maxit</span><span class="o">::</span><span class="kt">INT</span>
<span class="w">      </span><span class="n">cold_start</span><span class="o">::</span><span class="kt">INT</span>
<span class="w">      </span><span class="n">ratio_cg_vs_sd</span><span class="o">::</span><span class="kt">INT</span>
<span class="w">      </span><span class="n">change_max</span><span class="o">::</span><span class="kt">INT</span>
<span class="w">      </span><span class="n">cg_maxit</span><span class="o">::</span><span class="kt">INT</span>
<span class="w">      </span><span class="n">sif_file_device</span><span class="o">::</span><span class="kt">INT</span>
<span class="w">      </span><span class="n">infinity</span><span class="o">::</span><span class="kt">T</span>
<span class="w">      </span><span class="n">stop_p</span><span class="o">::</span><span class="kt">T</span>
<span class="w">      </span><span class="n">stop_d</span><span class="o">::</span><span class="kt">T</span>
<span class="w">      </span><span class="n">stop_c</span><span class="o">::</span><span class="kt">T</span>
<span class="w">      </span><span class="n">identical_bounds_tol</span><span class="o">::</span><span class="kt">T</span>
<span class="w">      </span><span class="n">stop_cg_relative</span><span class="o">::</span><span class="kt">T</span>
<span class="w">      </span><span class="n">stop_cg_absolute</span><span class="o">::</span><span class="kt">T</span>
<span class="w">      </span><span class="n">zero_curvature</span><span class="o">::</span><span class="kt">T</span>
<span class="w">      </span><span class="n">cpu_time_limit</span><span class="o">::</span><span class="kt">T</span>
<span class="w">      </span><span class="n">exact_arcsearch</span><span class="o">::</span><span class="kt">Bool</span>
<span class="w">      </span><span class="n">space_critical</span><span class="o">::</span><span class="kt">Bool</span>
<span class="w">      </span><span class="n">deallocate_error_fatal</span><span class="o">::</span><span class="kt">Bool</span>
<span class="w">      </span><span class="n">generate_sif_file</span><span class="o">::</span><span class="kt">Bool</span>
<span class="w">      </span><span class="n">sif_file_name</span><span class="o">::</span><span class="kt">NTuple</span><span class="p">{</span><span class="mi">31</span><span class="p">,</span><span class="kt">Cchar</span><span class="p">}</span>
<span class="w">      </span><span class="n">prefix</span><span class="o">::</span><span class="kt">NTuple</span><span class="p">{</span><span class="mi">31</span><span class="p">,</span><span class="kt">Cchar</span><span class="p">}</span>
<span class="w">      </span><span class="n">sbls_control</span><span class="o">::</span><span class="kt">sbls_control_type</span><span class="p">{</span><span class="kt">T</span><span class="p">,</span><span class="kt">INT</span><span class="p">}</span></pre>
</section>
<section id="detailed-documentation">
<span id="details-structbqp-control-type"></span><h2>detailed documentation<a class="headerlink" href="#detailed-documentation" title="Link to this heading">#</a></h2>
<p>control derived type as a Julia structure</p>
<section id="components">
<h3>components<a class="headerlink" href="#components" title="Link to this heading">#</a></h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-f-indexing"><span id="index-10"></span><span></span><span class="kt">Bool</span><span class="w"> </span><span class="n">f_indexing</span></pre>
<p>use C or Fortran sparse matrix indexing</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-error"><span id="index-11"></span><span></span><span class="n">INT</span><span class="w"> </span><span class="n">error</span></pre>
<p>unit number for error and warning diagnostics</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-out"><span id="index-12"></span><span></span><span class="n">INT</span><span class="w"> </span><span class="n">out</span></pre>
<p>general output unit number</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-print-level"><span id="index-13"></span><span></span><span class="n">INT</span><span class="w"> </span><span class="n">print_level</span></pre>
<p>the level of output required</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-start-print"><span id="index-14"></span><span></span><span class="n">INT</span><span class="w"> </span><span class="n">start_print</span></pre>
<p>on which iteration to start printing</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-stop-print"><span id="index-15"></span><span></span><span class="n">INT</span><span class="w"> </span><span class="n">stop_print</span></pre>
<p>on which iteration to stop printing</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-print-gap"><span id="index-16"></span><span></span><span class="n">INT</span><span class="w"> </span><span class="n">print_gap</span></pre>
<p>how many iterations between printing</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-maxit"><span id="index-17"></span><span></span><span class="n">INT</span><span class="w"> </span><span class="n">maxit</span></pre>
<p>how many iterations to perform (-ve reverts to HUGE(1)-1)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-cold-start"><span id="index-18"></span><span></span><span class="n">INT</span><span class="w"> </span><span class="n">cold_start</span></pre>
<p>cold_start should be set to 0 if a warm start is required (with variable assigned according to B_stat, see below), and to any other value if the values given in prob.X suffice</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-ratio-cg-vs-sd"><span id="index-19"></span><span></span><span class="n">INT</span><span class="w"> </span><span class="n">ratio_cg_vs_sd</span></pre>
<p>the ratio of how many iterations use CG rather steepest descent</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-change-max"><span id="index-20"></span><span></span><span class="n">INT</span><span class="w"> </span><span class="n">change_max</span></pre>
<p>the maximum number of per-iteration changes in the working set permitted when allowing CG rather than steepest descent</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-cg-maxit"><span id="index-21"></span><span></span><span class="n">INT</span><span class="w"> </span><span class="n">cg_maxit</span></pre>
<p>how many CG iterations to perform per BQP iteration (-ve reverts to n+1)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-sif-file-device"><span id="index-22"></span><span></span><span class="n">INT</span><span class="w"> </span><span class="n">sif_file_device</span></pre>
<p>the unit number to write generated SIF file describing the current problem</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-infinity"><span id="index-23"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">infinity</span></pre>
<p>any bound larger than infinity in modulus will be regarded as infinite</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-stop-p"><span id="index-24"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">stop_p</span></pre>
<p>the required accuracy for the primal infeasibility</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-stop-d"><span id="index-25"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">stop_d</span></pre>
<p>the required accuracy for the dual infeasibility</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-stop-c"><span id="index-26"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">stop_c</span></pre>
<p>the required accuracy for the complementary slackness</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-identical-bounds-tol"><span id="index-27"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">identical_bounds_tol</span></pre>
<p>any pair of constraint bounds (x_l,x_u) that are closer than i dentical_bounds_tol will be reset to the average of their values</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-stop-cg-relative"><span id="index-28"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">stop_cg_relative</span></pre>
<p>the CG iteration will be stopped as soon as the current norm of the preconditioned gradient is smaller than max( stop_cg_relative * initial preconditioned gradient, stop_cg_absolute)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-stop-cg-absolute"><span id="index-29"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">stop_cg_absolute</span></pre>
<p>see stop_cg_relative</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-zero-curvature"><span id="index-30"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">zero_curvature</span></pre>
<p>threshold below which curvature is regarded as zero</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-cpu-time-limit"><span id="index-31"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">cpu_time_limit</span></pre>
<p>the maximum CPU time allowed (-ve = no limit)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-exact-arcsearch"><span id="index-32"></span><span></span><span class="kt">Bool</span><span class="w"> </span><span class="n">exact_arcsearch</span></pre>
<p>exact_arcsearch is true if an exact arcsearch is required, and false if approximation suffices</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-space-critical"><span id="index-33"></span><span></span><span class="kt">Bool</span><span class="w"> </span><span class="n">space_critical</span></pre>
<p>if space_critical is true, every effort will be made to use as little space as possible. This may result in longer computation times</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-deallocate-error-fatal"><span id="index-34"></span><span></span><span class="kt">Bool</span><span class="w"> </span><span class="n">deallocate_error_fatal</span></pre>
<p>if deallocate_error_fatal is true, any array/pointer deallocation error will terminate execution. Otherwise, computation will continue</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-generate-sif-file"><span id="index-35"></span><span></span><span class="kt">Bool</span><span class="w"> </span><span class="n">generate_sif_file</span></pre>
<p>if generate_sif_file is true, a SIF file describing the current problem will be generated</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-sif-file-name"><span id="index-36"></span><span></span><span class="kt">NTuple</span><span class="p">{</span><span class="mi">31</span><span class="p">,</span><span class="kt">Cchar</span><span class="p">}</span><span class="w"> </span><span class="n">sif_file_name</span></pre>
<p>name (max 30 characters) of generated SIF file containing input problem</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-prefix"><span id="index-37"></span><span></span><span class="kt">NTuple</span><span class="p">{</span><span class="mi">31</span><span class="p">,</span><span class="kt">Cchar</span><span class="p">}</span><span class="w"> </span><span class="n">prefix</span></pre>
<p>all output lines will be prefixed by a string (max 30 characters) prefix(2:LEN(TRIM(.prefix))-1) where prefix contains the required string enclosed in quotes, e.g. “string” or ‘string’</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-control-type-sbls-control"><span id="index-38"></span><span></span><span class="n">struct</span><span class="w"> </span><a class="reference internal" href="struct_sbls_control_type.html#doxid-structsbls-control-type"><span class="std std-ref">sbls_control_type</span></a><span></span><span class="w"> </span><span class="n">sbls_control</span></pre>
<p>control parameters for SBLS</p>
</section>
</section>
<section id="bqp-time-type-structure">
<span id="doxid-structbqp-time-type"></span><span id="index-39"></span><h2>bqp_time_type structure<a class="headerlink" href="#bqp-time-type-structure" title="Link to this heading">#</a></h2>
<div class="toctree-wrapper compound">
</div>
<pre class="highlight doxyrest-overview-code-block literal-block"><span></span><span class="w">    </span><span class="k">struct</span> <span class="kt">bqp_time_type</span>
<span class="w">      </span><span class="n">total</span><span class="o">::</span><span class="kt">Float32</span>
<span class="w">      </span><span class="n">analyse</span><span class="o">::</span><span class="kt">Float32</span>
<span class="w">      </span><span class="n">factorize</span><span class="o">::</span><span class="kt">Float32</span>
<span class="w">      </span><span class="n">solve</span><span class="o">::</span><span class="kt">Float32</span></pre>
</section>
<section id="details-structbqp-time-type">
<span id="id1"></span><h2>detailed documentation<a class="headerlink" href="#details-structbqp-time-type" title="Link to this heading">#</a></h2>
<p>time derived type as a Julia structure</p>
<section id="id2">
<h3>components<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-time-type-total"><span id="index-40"></span><span></span><span class="kt">Float32</span><span class="w"> </span><span class="n">total</span></pre>
<p>total time</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-time-type-analyse"><span id="index-41"></span><span></span><span class="kt">Float32</span><span class="w"> </span><span class="n">analyse</span></pre>
<p>time for the analysis phase</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-time-type-factorize"><span id="index-42"></span><span></span><span class="kt">Float32</span><span class="w"> </span><span class="n">factorize</span></pre>
<p>time for the factorization phase</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-time-type-solve"><span id="index-43"></span><span></span><span class="kt">Float32</span><span class="w"> </span><span class="n">solve</span></pre>
<p>time for the linear solution phase</p>
</section>
</section>
<section id="bqp-inform-type-structure">
<span id="doxid-structbqp-inform-type"></span><span id="index-44"></span><h2>bqp_inform_type structure<a class="headerlink" href="#bqp-inform-type-structure" title="Link to this heading">#</a></h2>
<div class="toctree-wrapper compound">
</div>
<pre class="highlight doxyrest-overview-code-block literal-block"><span></span><span class="w">    </span><span class="k">struct</span> <span class="kt">bqp_inform_type</span><span class="p">{</span><span class="kt">T</span><span class="p">,</span><span class="kt">INT</span><span class="p">}</span>
<span class="w">      </span><span class="n">status</span><span class="o">::</span><span class="kt">INT</span>
<span class="w">      </span><span class="n">alloc_status</span><span class="o">::</span><span class="kt">INT</span>
<span class="w">      </span><span class="n">factorization_status</span><span class="o">::</span><span class="kt">INT</span>
<span class="w">      </span><span class="n">iter</span><span class="o">::</span><span class="kt">INT</span>
<span class="w">      </span><span class="n">cg_iter</span><span class="o">::</span><span class="kt">INT</span>
<span class="w">      </span><span class="n">obj</span><span class="o">::</span><span class="kt">T</span>
<span class="w">      </span><span class="n">norm_pg</span><span class="o">::</span><span class="kt">T</span>
<span class="w">      </span><span class="n">bad_alloc</span><span class="o">::</span><span class="kt">NTuple</span><span class="p">{</span><span class="mi">81</span><span class="p">,</span><span class="kt">Cchar</span><span class="p">}</span>
<span class="w">      </span><span class="n">time</span><span class="o">::</span><span class="kt">bqp_time_type</span>
<span class="w">      </span><span class="n">sbls_inform</span><span class="o">::</span><span class="kt">sbls_inform_type</span><span class="p">{</span><span class="kt">T</span><span class="p">,</span><span class="kt">INT</span><span class="p">}</span></pre>
</section>
<section id="details-structbqp-inform-type">
<span id="id3"></span><h2>detailed documentation<a class="headerlink" href="#details-structbqp-inform-type" title="Link to this heading">#</a></h2>
<p>inform derived type as a Julia structure</p>
<section id="id4">
<h3>components<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-inform-type-status"><span id="index-45"></span><span></span><span class="n">INT</span><span class="w"> </span><span class="n">status</span></pre>
<p>reported return status:</p>
<ul>
<li><p><strong>0</strong></p>
<p>success</p>
</li>
<li><p><strong>-1</strong></p>
<p>allocation error</p>
</li>
<li><p><strong>-2</strong></p>
<p>deallocation error</p>
</li>
<li><p><strong>-3</strong></p>
<p>matrix data faulty (.n &lt; 1, .ne &lt; 0)</p>
</li>
<li><p><strong>-20</strong></p>
<p>alegedly +ve definite matrix is not</p>
</li>
</ul>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-inform-type-alloc-status"><span id="index-46"></span><span></span><span class="n">INT</span><span class="w"> </span><span class="n">alloc_status</span></pre>
<p>Fortran STAT value after allocate failure.</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-inform-type-factorization-status"><span id="index-47"></span><span></span><span class="n">INT</span><span class="w"> </span><span class="n">factorization_status</span></pre>
<p>status return from factorization</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-inform-type-iter"><span id="index-48"></span><span></span><span class="n">INT</span><span class="w"> </span><span class="n">iter</span></pre>
<p>number of iterations required</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-inform-type-cg-iter"><span id="index-49"></span><span></span><span class="n">INT</span><span class="w"> </span><span class="n">cg_iter</span></pre>
<p>number of CG iterations required</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-inform-type-obj"><span id="index-50"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">obj</span></pre>
<p>current value of the objective function</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-inform-type-norm-pg"><span id="index-51"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">norm_pg</span></pre>
<p>current value of the projected gradient</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-inform-type-bad-alloc"><span id="index-52"></span><span></span><span class="kt">NTuple</span><span class="p">{</span><span class="mi">81</span><span class="p">,</span><span class="kt">Cchar</span><span class="p">}</span><span class="w"> </span><span class="n">bad_alloc</span></pre>
<p>name of array which provoked an allocate failure</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-inform-type-time"><span id="index-53"></span><span></span><span class="n">struct</span><span class="w"> </span><a class="reference internal" href="struct_bqp_time_type.html#doxid-structbqp-time-type"><span class="std std-ref">bqp_time_type</span></a><span></span><span class="w"> </span><span class="n">time</span></pre>
<p>times for various stages</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structbqp-inform-type-sbls-inform"><span id="index-54"></span><span></span><span class="n">struct</span><span class="w"> </span><a class="reference internal" href="struct_sbls_inform_type.html#doxid-structsbls-inform-type"><span class="std std-ref">sbls_inform_type</span></a><span></span><span class="w"> </span><span class="n">sbls_inform</span></pre>
<p>inform values from SBLS</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></div>
</div>
</section>
</section>
<section id="example-calls">
<span id="doxid-index-bqp-examples"></span><h2>example calls<a class="headerlink" href="#example-calls" title="Link to this heading">#</a></h2>
<p>This is an example of how to use the package to solve a bound-constrained QP;
the code is available in $GALAHAD/src/bqp/Julia/test_bqp.jl .
A variety of supported  matrix storage formats are shown.</p>
<div class="code julia highlight-default notranslate"><div class="highlight"><pre><span></span># test_bqp.jl
# Simple code to test the Julia interface to BQP

using GALAHAD
using Test
using Printf
using Accessors
using Quadmath

function test_bqp(::Type{T}, ::Type{INT}) where {T,INT}
  # Derived types
  data = Ref{Ptr{Cvoid}}()
  control = Ref{bqp_control_type{T,INT}}()
  inform = Ref{bqp_inform_type{T,INT}}()

  # Set problem data
  n = INT(10)  # dimension
  H_ne = 2 * n - 1 # Hesssian elements, NB lower triangle
  H_dense_ne = div(n * (n + 1), 2) # dense Hessian elements
  H_row = zeros(INT, H_ne) # row indices,
  H_col = zeros(INT, H_ne) # column indices
  H_ptr = zeros(INT, n + 1)  # row pointers
  H_val = zeros(T, H_ne) # values
  H_dense = zeros(T, H_dense_ne) # dense values
  H_diag = zeros(T, n)   # diagonal values
  g = zeros(T, n)  # linear term in the objective
  f = one(T)  # constant term in the objective
  x_l = zeros(T, n) # variable lower bound
  x_u = zeros(T, n) # variable upper bound
  x = zeros(T, n) # variables
  z = zeros(T, n) # dual variables

  # Set output storage
  x_stat = zeros(INT, n) # variable status
  st = &#39; &#39;
  status = Ref{INT}()

  g[1] = 2.0
  for i in 2:n
    g[i] = 0.0
  end
  x_l[1] = -1.0
  for i in 2:n
    x_l[i] = -Inf
  end
  x_u[1] = 1.0
  x_u[2] = Inf
  for i in 3:n
    x_u[i] = 2.0
  end

  # H = tridiag(2,1), H_dense = diag(2)
  l = 1
  H_ptr[1] = l
  H_row[l] = 1
  H_col[l] = 1
  H_val[l] = 2.0
  for i in 2:n
    l = l + 1
    H_ptr[i] = l
    H_row[l] = i
    H_col[l] = i - 1
    H_val[l] = 1.0
    l = l + 1
    H_row[l] = i
    H_col[l] = i
    H_val[l] = 2.0
  end
  H_ptr[n + 1] = l + 1

  l = 0
  for i in 1:n
    H_diag[i] = 2.0
    for j in 1:i
      l = l + 1
      if j &lt; i - 1
        H_dense[l] = 0.0
      elseif j == i - 1
        H_dense[l] = 1.0
      else
        H_dense[l] = 2.0
      end
    end
  end

  @printf(&quot; fortran sparse matrix indexing\n\n&quot;)
  @printf(&quot; basic tests of bqp storage formats\n\n&quot;)

  for d in 1:4

    # Initialize BQP
    bqp_initialize(T, INT, data, control, status)

    # Start from 0
    for i in 1:n
      x[i] = 0.0
      z[i] = 0.0
    end

    # sparse co-ordinate storage
    if d == 1
      st = &#39;C&#39;
      bqp_import(T, INT, control, data, status, n,
                 &quot;coordinate&quot;, H_ne, H_row, H_col, C_NULL)

      bqp_solve_given_h(T, INT, data, status, n, H_ne, H_val, g, f,
                        x_l, x_u, x, z, x_stat)
    end

    # sparse by rows
    if d == 2
      st = &#39;R&#39;
      bqp_import(T, INT, control, data, status, n,
                 &quot;sparse_by_rows&quot;, H_ne, C_NULL, H_col, H_ptr)

      bqp_solve_given_h(T, INT, data, status, n, H_ne, H_val, g, f,
                        x_l, x_u, x, z, x_stat)
    end

    # dense
    if d == 3
      st = &#39;D&#39;
      bqp_import(T, INT, control, data, status, n,
                 &quot;dense&quot;, H_dense_ne, C_NULL, C_NULL, C_NULL)

      bqp_solve_given_h(T, INT, data, status, n, H_dense_ne, H_dense,
                        g, f, x_l, x_u, x, z, x_stat)
    end

    # diagonal
    if d == 4
      st = &#39;L&#39;
      bqp_import(T, INT, control, data, status, n,
                 &quot;diagonal&quot;, H_ne, C_NULL, C_NULL, C_NULL)

      bqp_solve_given_h(T, INT, data, status, n, n, H_diag, g, f,
                        x_l, x_u, x, z, x_stat)
    end

    bqp_information(T, INT, data, inform, status)

    if inform[].status == 0
      @printf(&quot;%c:%6i iterations. Optimal objective value = %5.2f status = %1i\n&quot;, st,
              inform[].iter, inform[].obj, inform[].status)
    else
      @printf(&quot;%c: BQP_solve exit status = %1i\n&quot;, st, inform[].status)
    end

    # @printf(&quot;x: &quot;)
    # for i = 1:n
    #   @printf(&quot;%f &quot;, x[i])
    # end
    # @printf(&quot;\n&quot;)
    # @printf(&quot;gradient: &quot;)
    # for i = 1:n
    #   @printf(&quot;%f &quot;, g[i])
    # end
    # @printf(&quot;\n&quot;)

    # Delete internal workspace
    bqp_terminate(T, INT, data, control, inform)
  end

  @printf(&quot;\n tests reverse-communication options\n\n&quot;)

  # reverse-communication input/output
  nz_v_start = Ref{INT}()
  nz_v_end = Ref{INT}()
  nz_v = zeros(INT, n)
  nz_prod = zeros(INT, n)
  mask = zeros(INT, n)
  v = zeros(T, n)
  prod = zeros(T, n)

  nz_prod_end = 1

  # Initialize BQP
  bqp_initialize(T, INT, data, control, status)
  # @reset control[].print_level = 1

  # Start from 0
  for i in 1:n
    x[i] = 0.0
    z[i] = 0.0
  end

  st = &#39;I&#39;
  for i in 1:n
    mask[i] = 0
  end
  bqp_import_without_h(T, INT, control, data, status, n)

  terminated = false
  while !terminated # reverse-communication loop
    bqp_solve_reverse_h_prod(T, INT, data, status, n, g, f, x_l, x_u, x, z, x_stat, v, prod, nz_v,
                             nz_v_start, nz_v_end, nz_prod, nz_prod_end)

    if status[] == 0 # successful termination
      terminated = true
    elseif status[] &lt; 0 # error exit
      terminated = true
    elseif status[] == 2 # evaluate Hv
      prod[1] = 2.0 * v[1] + v[2]
      for i in 2:(n - 1)
        prod[i] = 2.0 * v[i] + v[i - 1] + v[i + 1]
      end
      prod[n] = 2.0 * v[n] + v[n - 1]
    elseif status[] == 3 # evaluate Hv for sparse v
      for i in 1:n
        prod[i] = 0.0
      end
      for l in nz_v_start[]:nz_v_end[]
        i = nz_v[l]
        if i &gt; 1
          prod[i - 1] = prod[i - 1] + v[i]
        end
        prod[i] = prod[i] + 2.0 * v[i]
        if i &lt; n
          prod[i + 1] = prod[i + 1] + v[i]
        end
      end
    elseif status[] == 4 # evaluate sarse Hv for sparse v
      nz_prod_end = 1
      for l in nz_v_start[]:nz_v_end[]
        i = nz_v[l]
        if i &gt; 1
          if mask[i - 1] == 0
            mask[i - 1] = 1
            nz_prod[nz_prod_end] = i - 1
            nz_prod_end = nz_prod_end + 1
            prod[i - 1] = v[i]
          else
            prod[i - 1] = prod[i - 1] + v[i]
          end
        end
        if mask[i] == 0
          mask[i] = 1
          nz_prod[nz_prod_end] = i
          nz_prod_end = nz_prod_end + 1
          prod[i] = 2.0 * v[i]
        else
          prod[i] = prod[i] + 2.0 * v[i]
        end
        if i &lt; n
          if mask[i + 1] == 0
            mask[i + 1] = 1
            nz_prod[nz_prod_end] = i + 1
            nz_prod_end = nz_prod_end + 1
          end
          prod[i + 1] = prod[i + 1] + v[i]
        end
        for l in 1:nz_prod_end
          mask[nz_prod[l]] = 0
        end
      end
    else
      @printf(&quot; the value %1i of status should not occur\n&quot;, status[])
    end
  end

  # Record solution information
  bqp_information(T, INT, data, inform, status)

  # Print solution details
  if inform[].status == 0
    @printf(&quot;%c:%6i iterations. Optimal objective value = %5.2f status = %1i\n&quot;, st,
            inform[].iter, inform[].obj, inform[].status)
  else
    @printf(&quot;%c: BQP_solve exit status = %1i\n&quot;, st, inform[].status)
  end

  # @printf(&quot;x: &quot;)
  # for i = 1:n
  #   @printf(&quot;%f &quot;, x[i])
  # end
  # @printf(&quot;\n&quot;)
  # @printf(&quot;gradient: &quot;)
  # for i = 1:n
  #   @printf(&quot;%f &quot;, g[i])
  # end
  # @printf(&quot;\n&quot;)

  # Delete internal workspace
  bqp_terminate(T, INT, data, control, inform)
  return 0
end

for (T, INT, libgalahad) in ((Float32 , Int32, GALAHAD.libgalahad_single      ),
                             (Float32 , Int64, GALAHAD.libgalahad_single_64   ),
                             (Float64 , Int32, GALAHAD.libgalahad_double      ),
                             (Float64 , Int64, GALAHAD.libgalahad_double_64   ),
                             (Float128, Int32, GALAHAD.libgalahad_quadruple   ),
                             (Float128, Int64, GALAHAD.libgalahad_quadruple_64))
  if isfile(libgalahad)
    @testset &quot;BQP -- $T -- $INT&quot; begin
      @test test_bqp(T, INT) == 0
    end
  end
end
</pre></div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="qp.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Quadratic Programming</p>
      </div>
    </a>
    <a class="right-next"
       href="bqp_functions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">callable functions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#purpose">purpose</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#terminology">terminology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#method">method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reference">reference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-storage">matrix storage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-function-calls">introduction to function calls</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parametric-real-type-t-and-integer-type-int">parametric real type T and integer type INT</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#callable-functions">callable functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#available-structures">available structures</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bqp-control-type-structure">bqp_control_type structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detailed-documentation">detailed documentation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#components">components</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bqp-time-type-structure">bqp_time_type structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#details-structbqp-time-type">detailed documentation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">components</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bqp-inform-type-structure">bqp_inform_type structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#details-structbqp-inform-type">detailed documentation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">components</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-calls">example calls</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="_sources/bqp.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright Gould/Orban/Toint, for GALAHAD productions, GALAHAD 4 C/Python interfaces copyright Fowkes/Gould, GALAHAD 5 Julia interfaces copyright Fowkes/Gould/Montoison/Orban.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>