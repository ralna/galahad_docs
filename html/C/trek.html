
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>GALAHAD TREK package &#8212; GALAHAD C interfaces 1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/doxyrest-pygments.css?v=ff3f4257" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=a6bbf7ec" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=f2a433a1"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/target-highlight.js?v=df7d332b"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'trek';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="overview of functions provided" href="trek_functions.html" />
    <link rel="prev" title="rqs_inform_type structure" href="struct_rqs_inform_type.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/galahad.small.png" class="logo__image only-light" alt="GALAHAD C interfaces 1.0 documentation - Home"/>
    <img src="_static/galahad.small.png" class="logo__image only-dark pst-js-only" alt="GALAHAD C interfaces 1.0 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="uco.html">
    Unconstrained Optimization
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="bco.html">
    Bound-constrained Optimization
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="nlp.html">
    Generally-constrained Optimization
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="ls.html">
    Least-Squares
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="lp.html">
    Linear Programming
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="qp.html">
    Quadratic Programming
  </a>
</li>


<li class=" current active">
  <a class="nav-link dropdown-item nav-internal" href="reg.html">
    Regularization subproblems
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="sys.html">
    Linear Systems
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="go.html">
    Global Optimization
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="auxiliary.html">
    Auxiliary Procedures
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="uco.html">
    Unconstrained Optimization
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="bco.html">
    Bound-constrained Optimization
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="nlp.html">
    Generally-constrained Optimization
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="ls.html">
    Least-Squares
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="lp.html">
    Linear Programming
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="qp.html">
    Quadratic Programming
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="reg.html">
    Regularization subproblems
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="sys.html">
    Linear Systems
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="go.html">
    Global Optimization
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="auxiliary.html">
    Auxiliary Procedures
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="trs.html">TRS - global minization of a quadratic function within an ellipsoid using matrix factorization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="trs_functions.html">overview of functions provided</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_trs_control_type.html">trs_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_trs_time_type.html">trs_time_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_trs_history_type.html">trs_history_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_trs_inform_type.html">trs_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>



<li class="toctree-l2 has-children"><a class="reference internal" href="struct_trs_control_type.html">trs_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_trs_time_type.html">trs_time_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_trs_history_type.html">trs_history_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_trs_inform_type.html">trs_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="rqs.html">RQS - global minization of a regularized quadratic function using matrix factorization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="rqs_functions.html">overview of functions provided</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_rqs_control_type.html">rqs_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_rqs_time_type.html">rqs_time_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_rqs_history_type.html">rqs_history_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_rqs_inform_type.html">rqs_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>



<li class="toctree-l2 has-children"><a class="reference internal" href="struct_rqs_control_type.html">rqs_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_rqs_time_type.html">rqs_time_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_rqs_history_type.html">rqs_history_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_rqs_inform_type.html">rqs_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">TREK - global minization of a quadratic function within an ellipsoid using extended-Krylov-subspace iteration</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="trek_functions.html">overview of functions provided</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_trek_control_type.html">trek_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_trek_time_type.html">trek_time_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_trek_inform_type.html">trek_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>



<li class="toctree-l2 has-children"><a class="reference internal" href="struct_trek_control_type.html">trek_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_trek_time_type.html">trek_time_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_trek_inform_type.html">trek_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="dps.html">DPS - global minization of a regularized quadratic function in a diagonalising norm using matrix factorization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="dps_functions.html">overview of functions provided</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_dps_control_type.html">dps_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_dps_time_type.html">dps_time_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_dps_inform_type.html">dps_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>



<li class="toctree-l2 has-children"><a class="reference internal" href="struct_dps_control_type.html">dps_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_dps_time_type.html">dps_time_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_dps_inform_type.html">dps_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="gltr.html">GLTR - global minization of a quadratic function within an ellipsoid using an iterative method</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="gltr_functions.html">overview of functions provided</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_gltr_control_type.html">gltr_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_gltr_inform_type.html">gltr_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>



<li class="toctree-l2 has-children"><a class="reference internal" href="struct_gltr_control_type.html">gltr_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_gltr_inform_type.html">gltr_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="glrt.html">GLRT - global minization of a regularized quadratic function</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="glrt_functions.html">overview of functions provided</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_glrt_control_type.html">glrt_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_glrt_inform_type.html">glrt_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>



<li class="toctree-l2 has-children"><a class="reference internal" href="struct_glrt_control_type.html">glrt_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_glrt_inform_type.html">glrt_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="llsr.html">LLSR - global minization of a regularized linear least-squares objective using matrix factorizations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="llsr_functions.html">overview of functions provided</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_llsr_control_type.html">llsr_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_llsr_time_type.html">llsr_time_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_llsr_history_type.html">llsr_history_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_llsr_inform_type.html">llsr_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>



<li class="toctree-l2 has-children"><a class="reference internal" href="struct_llsr_control_type.html">llsr_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_llsr_time_type.html">llsr_time_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_llsr_history_type.html">llsr_history_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_llsr_inform_type.html">llsr_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="llst.html">LLST - global minization of a linear least-squares objective within an ellipsoid using matrix factorizations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="llst_functions.html">overview of functions provided</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_llst_control_type.html">llst_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_llst_time_type.html">llst_time_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_llst_history_type.html">llst_history_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_llst_inform_type.html">llst_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>



<li class="toctree-l2 has-children"><a class="reference internal" href="struct_llst_control_type.html">llst_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_llst_time_type.html">llst_time_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_llst_history_type.html">llst_history_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_llst_inform_type.html">llst_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lstr.html">LSTR - global minization of a linear least-squares objective within a sphere using an iterative method</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="lstr_functions.html">overview of functions provided</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_lstr_control_type.html">lstr_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_lstr_inform_type.html">lstr_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>



<li class="toctree-l2 has-children"><a class="reference internal" href="struct_lstr_control_type.html">lstr_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_lstr_inform_type.html">lstr_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lsrt.html">LSRT - global minization of a regularized linear least-squares objective using an iterative method</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="lsrt_functions.html">overview of functions provided</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_lsrt_control_type.html">lsrt_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_lsrt_inform_type.html">lsrt_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>



<li class="toctree-l2 has-children"><a class="reference internal" href="struct_lsrt_control_type.html">lsrt_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_lsrt_inform_type.html">lsrt_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="l2rt.html">L2RT - global minization of a regularized linear least-Euclidean-norm objective using an iterative method</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="l2rt_functions.html">overview of functions provided</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_l2rt_control_type.html">l2rt_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_l2rt_inform_type.html">l2rt_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>



<li class="toctree-l2 has-children"><a class="reference internal" href="struct_l2rt_control_type.html">l2rt_control_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_l2rt_inform_type.html">l2rt_inform_type structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>

</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="reg.html" class="nav-link">Regularization subproblems</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">GALAHAD TREK package</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-galahad.trek">
<span id="galahad-trek-package"></span><span id="doxid-index-trek"></span><h1>GALAHAD TREK package<a class="headerlink" href="#module-galahad.trek" title="Link to this heading">#</a></h1>
<section id="purpose">
<h2>purpose<a class="headerlink" href="#purpose" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">trek</span></code> package uses an <strong>extended-Krylov-subspace iteration</strong> to find the
global minimizer of a <strong>quadratic objective function</strong> within
an <strong>ellipsoidal region</strong>; this is commonly known as the
<strong>trust-region subproblem</strong>.
The aim is to minimize the quadratic objective function
<div class="math notranslate nohighlight">
\[q(x) = f + c^T x + \frac{1}{2} x^T H x,\]</div>

where the vector <span class="math notranslate nohighlight">\(x\)</span> is required to satisfy
the ellipsoidal  <strong>trust-region constraint</strong> <span class="math notranslate nohighlight">\(\|x\|_S \leq  \Delta\)</span>.
where the <span class="math notranslate nohighlight">\(S\)</span>-norm of <span class="math notranslate nohighlight">\(x\)</span> is defined to be <span class="math notranslate nohighlight">\(\|x\|_S = \sqrt{x^T S x}\)</span>,
and where the <strong>radius</strong> <span class="math notranslate nohighlight">\(\Delta &gt; 0\)</span>.
The matrix <span class="math notranslate nohighlight">\(S\)</span> need not be provided in the commonly-occurring
<span class="math notranslate nohighlight">\(\ell_2\)</span>-trust-region case for which <span class="math notranslate nohighlight">\(S = I\)</span>, the <span class="math notranslate nohighlight">\(n\)</span> by <span class="math notranslate nohighlight">\(n\)</span>
identity matrix.</p>
<p>Factorization of the matrices <span class="math notranslate nohighlight">\(H\)</span> and, if present, <span class="math notranslate nohighlight">\(S\)</span>
will be required, so this package is most suited
for the case where such a factorization may be found efficiently. If
this is not the case, the package <code class="docutils literal notranslate"><span class="pre">gltr</span></code> may be preferred.</p>
<p>See Section 4 of $GALAHAD/doc/trek.pdf for additional details.</p>
</section>
<section id="method">
<h2>method<a class="headerlink" href="#method" title="Link to this heading">#</a></h2>
<p>The required solution <span class="math notranslate nohighlight">\(x_*\)</span> necessarily satisfies the optimality condition
<span class="math notranslate nohighlight">\(H x_* + \lambda_* S x_* + c = 0\)</span>, where <span class="math notranslate nohighlight">\(\lambda_* \geq 0\)</span> is a Lagrange
multiplier corresponding to the constraint <span class="math notranslate nohighlight">\(\|x\|_M  \leq  \Delta\)</span>.
In addition in all cases, the matrix <span class="math notranslate nohighlight">\(H + \lambda_* S\)</span> will be positive
semi-definite; in most instances it will actually be positive definite,
but in special “hard” cases singularity is a possibility.</p>
<p>The method is iterative, and is based upon building a solution approximation
from an orthogonal basis of the evolving extended Krylov subspaces
<span class="math notranslate nohighlight">\({\cal K}_{2m+1}(H,c) = \mbox{span}\{c,H^{-1}c,H c,H^{-2}c,H^2c,\ldots,\)</span>
<span class="math notranslate nohighlight">\(H^{-m}c,H^{m}c\}\)</span>
as <span class="math notranslate nohighlight">\(m\)</span> increases. The key observations are (i) the manifold of
solutions to the optimality system
\[ ( H + \lambda I ) x(\lambda) = - c\]
as a function of <span class="math notranslate nohighlight">\(\sigma\)</span> is of approximately very low rank, (ii)
the subspace <span class="math notranslate nohighlight">\({\cal K}_{2m+1}(H,c)\)</span> rapidly gives a very good
approximation to this manifold, (iii) it is straightforward to
build an orthogonal basis of <span class="math notranslate nohighlight">\({\cal K}_{2m+1}(H,c)\)</span>
using short-term recurrences and a single factorization of <span class="math notranslate nohighlight">\(H\)</span>, and
(iv) solutions to the trust-region subproblem restricted to elements
of the orthogonal subspace may be found very efficiently
using effective high-order root-finding methods. The fact that the
second element in the subspace is <span class="math notranslate nohighlight">\(H^{-1} c\)</span> means that it is easy
to check for the interior-solution possibility <span class="math notranslate nohighlight">\(x = - H^{-1} c\)</span>
that occurs when such a <span class="math notranslate nohighlight">\(x\)</span> satisfies <span class="math notranslate nohighlight">\(\|x\| \leq \Delta\)</span>.
Coping with general scalings <span class="math notranslate nohighlight">\(S\)</span> is a straightforward extension so long
as factorization of <span class="math notranslate nohighlight">\(S\)</span> is also possible.</p>
</section>
<section id="reference">
<h2>reference<a class="headerlink" href="#reference" title="Link to this heading">#</a></h2>
<p>The method is described in detail in</p>
<blockquote>
<div><p>H. Al Daas and N. I. M. Gould.
Extended-Krylov-subspace methods for trust-region and norm-regularization
subproblems. Preprint STFC-P-2025-002, Rutherford Appleton Laboratory,
Oxfordshire, England.</p>
</div></blockquote>
</section>
<section id="matrix-storage">
<span id="details-trek-storage-sym"></span><h2>matrix storage<a class="headerlink" href="#matrix-storage" title="Link to this heading">#</a></h2>
<p>The <strong>symmetric</strong> <span class="math notranslate nohighlight">\(n\)</span> by <span class="math notranslate nohighlight">\(n\)</span> matrices <span class="math notranslate nohighlight">\(H\)</span> and, optionally, <span class="math notranslate nohighlight">\(S\)</span> may also
be presented and stored in a variety of formats. But crucially symmetry
is exploited by only storing values from the <em>lower triangular</em> part
(i.e, those entries that lie on or below the leading diagonal).</p>
<p><em>Dense</em> storage format:
The matrix <span class="math notranslate nohighlight">\(H\)</span> is stored as a compact  dense matrix by rows, that
is, the values of the entries of each row in turn are stored in order
within an appropriate real one-dimensional array. Since <span class="math notranslate nohighlight">\(H\)</span> is
symmetric, only the lower triangular part (that is the part
<span class="math notranslate nohighlight">\(H_{ij}\)</span> for <span class="math notranslate nohighlight">\(0 \leq j \leq i \leq n-1\)</span>) need be held.
In this case the lower triangle should be stored by rows, that is
component <span class="math notranslate nohighlight">\(i * i / 2 + j\)</span>  of the storage array H_val
will hold the value <span class="math notranslate nohighlight">\(H_{ij}\)</span> (and, by symmetry, <span class="math notranslate nohighlight">\(H_{ji}\)</span>)
for <span class="math notranslate nohighlight">\(0 \leq j \leq i \leq n-1\)</span>.
The string H_type = ‘dense’ should be specified.</p>
<p><em>Sparse co-ordinate</em> storage format:
Only the nonzero entries of the matrices are stored.
For the <span class="math notranslate nohighlight">\(l\)</span>-th entry, <span class="math notranslate nohighlight">\(0 \leq l \leq ne-1\)</span>, of <span class="math notranslate nohighlight">\(H\)</span>,
its row index i, column index j and value <span class="math notranslate nohighlight">\(H_{ij}\)</span>,
<span class="math notranslate nohighlight">\(0 \leq j \leq i \leq n-1\)</span>,  are stored as the <span class="math notranslate nohighlight">\(l\)</span>-th
components of the integer arrays H_row and H_col and real array H_val,
respectively, while the number of nonzeros is recorded as
H_ne = <span class="math notranslate nohighlight">\(ne\)</span>. Note that only the entries in the lower triangle
should be stored.
The string H_type = ‘coordinate’ should be specified.</p>
<p><em>Sparse row-wise</em> storage format:
Again only the nonzero entries are stored, but this time
they are ordered so that those in row i appear directly before those
in row i+1. For the i-th row of <span class="math notranslate nohighlight">\(H\)</span> the i-th component of the
integer array H_ptr holds the position of the first entry in this row,
while H_ptr(n) holds the total number of entries.
The column indices j, <span class="math notranslate nohighlight">\(0 \leq j \leq i\)</span>, and values
<span class="math notranslate nohighlight">\(H_{ij}\)</span> of the  entries in the i-th row are stored in components
l = H_ptr(i), …, H_ptr(i+1)-1 of the
integer array H_col, and real array H_val, respectively. Note that as before
only the entries in the lower triangle should be stored. For sparse matrices,
this scheme almost always requires less storage than its predecessor.
The string H_type = ‘sparse_by_rows’ should be specified.</p>
<p><em>Diagonal</em> storage format:
If <span class="math notranslate nohighlight">\(H\)</span> is diagonal (i.e., <span class="math notranslate nohighlight">\(H_{ij} = 0\)</span> for all
<span class="math notranslate nohighlight">\(0 \leq i \neq j \leq n-1\)</span>) only the diagonals entries
<span class="math notranslate nohighlight">\(H_{ii}\)</span>, <span class="math notranslate nohighlight">\(0 \leq i \leq n-1\)</span> need be stored,
and the first n components of the array H_val may be used for the purpose.
The string H_type = ‘diagonal’ should be specified.</p>
<p><em>Multiples of the identity</em> storage format:
If <span class="math notranslate nohighlight">\(H\)</span> is a multiple of the identity matrix, (i.e., <span class="math notranslate nohighlight">\(H = \alpha I\)</span>
where <span class="math notranslate nohighlight">\(I\)</span> is the n by n identity matrix and <span class="math notranslate nohighlight">\(\alpha\)</span> is a scalar),
it suffices to store <span class="math notranslate nohighlight">\(\alpha\)</span> as the first component of H_val.
The string H_type = ‘scaled_identity’ should be specified.</p>
<p>The <em>identity matrix</em> format:
If <span class="math notranslate nohighlight">\(H\)</span> is the identity matrix, no values need be stored.
The string H_type = ‘identity’ should be specified.</p>
<p>The <em>zero matrix</em> format:
The same is true if <span class="math notranslate nohighlight">\(H\)</span> is the zero matrix, but now
the string H_type = ‘zero’ or ‘none’ should be specified.</p>
<div class="toctree-wrapper compound">
</div>
</section>
<section id="introduction-to-function-calls">
<h2>introduction to function calls<a class="headerlink" href="#introduction-to-function-calls" title="Link to this heading">#</a></h2>
<p>To solve a given problem, functions from the trek package must be
called in the following order:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#doxid-galahad-trek-8h-1acb066d992c4ec394402bc7b7317e1163"><span class="std std-ref">trek_initialize</span></a> - provide default control parameters and set up initial data structures</p></li>
<li><p><a class="reference internal" href="#doxid-galahad-trek-8h-1adc7c56e7be2f7cc9d32921582d379b13"><span class="std std-ref">trek_read_specfile</span></a> (optional) - override control values by reading replacement values from a file</p></li>
<li><p><a class="reference internal" href="#doxid-galahad-trek-8h-1a4becded30e9b95fe7028b7799292c0af"><span class="std std-ref">trek_import</span></a> - set up problem data structures and fixed values</p></li>
<li><p><a class="reference internal" href="#doxid-galahad-trek-8h-1a427420b6025d522bb7b3c652e8c2be48"><span class="std std-ref">trek_import_s</span></a> - (optional) set up problem data structures and fixed values for the scaling matrix <span class="math notranslate nohighlight">\(S\)</span>, if any</p></li>
<li><p><a class="reference internal" href="#doxid-galahad-trek-8h-1aae677e64bacb35354f49326815b694c3"><span class="std std-ref">trek_reset_control</span></a> (optional) - possibly change control parameters if a sequence of problems are being solved</p></li>
<li><p><a class="reference internal" href="#doxid-galahad-trek-8h-1aadb8a751c29efcef663bf9560a1f9a8e"><span class="std std-ref">trek_solve_problem</span></a> - solve the trust-region problem</p></li>
<li><p><a class="reference internal" href="#doxid-galahad-trek-8h-1a3dda24010e564e2d6536cc7ea518451e"><span class="std std-ref">trek_information</span></a> (optional) - recover information about the solution and solution process</p></li>
<li><p><a class="reference internal" href="#doxid-galahad-trek-8h-1ab5cf0077db0631814fdd03599a585376"><span class="std std-ref">trek_terminate</span></a> - deallocate data structures</p></li>
</ul>
<p>See the <a class="reference internal" href="#doxid-index-trek-examples"><span class="std std-ref">examples</span></a> section for
illustrations of use.</p>
</section>
<section id="callable-functions">
<h2>callable functions<a class="headerlink" href="#callable-functions" title="Link to this heading">#</a></h2>
</section>
<section id="overview-of-functions-provided">
<span id="global"></span><h2>overview of functions provided<a class="headerlink" href="#overview-of-functions-provided" title="Link to this heading">#</a></h2>
<div class="toctree-wrapper compound">
</div>
<pre class="highlight doxyrest-overview-code-block literal-block"><span></span><span class="c1">// typedefs</span>

<span class="k">typedef</span> <span class="kt">float</span> <a class="reference internal" href="#doxid-galahad-spc-8h"><span class="std std-ref">spc_</span></a><span></span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">double</span> <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">int</span> <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span><span class="p">;</span>

<span class="c1">// structs</span>

<span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-control-type"><span class="std std-ref">trek_control_type</span></a><span></span><span class="p">;</span>
<span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-time-type"><span class="std std-ref">trek_time_type</span></a><span></span><span class="p">;</span>
<span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-inform-type"><span class="std std-ref">trek_inform_type</span></a><span></span><span class="p">;</span>

<span class="c1">// global functions</span>

<span class="kt">void</span> <a class="reference internal" href="#doxid-galahad-trek-8h-1acb066d992c4ec394402bc7b7317e1163"><span class="std std-ref">trek_initialize</span></a><span></span><span class="p">(</span><span class="kt">void</span> <span class="o">**</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-control-type"><span class="std std-ref">trek_control_type</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span> <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="o">*</span><span class="n">status</span><span class="p">);</span>
<span class="kt">void</span> <a class="reference internal" href="#doxid-galahad-trek-8h-1adc7c56e7be2f7cc9d32921582d379b13"><span class="std std-ref">trek_read_specfile</span></a><span></span><span class="p">(</span><span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-control-type"><span class="std std-ref">trek_control_type</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="n">specfile</span><span class="p">[]);</span>

<span class="kt">void</span> <a class="reference internal" href="#doxid-galahad-trek-8h-1a4becded30e9b95fe7028b7799292c0af"><span class="std std-ref">trek_import</span></a><span></span><span class="p">(</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-control-type"><span class="std std-ref">trek_control_type</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span>
    <span class="kt">void</span> <span class="o">**</span><span class="n">data</span><span class="p">,</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="o">*</span><span class="n">status</span><span class="p">,</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">n</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">char</span> <span class="n">H_type</span><span class="p">[],</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">H_ne</span><span class="p">,</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">H_row</span><span class="p">[],</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">H_col</span><span class="p">[],</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">H_ptr</span><span class="p">[]</span>
<span class="p">);</span>

<span class="kt">void</span> <a class="reference internal" href="#doxid-galahad-trek-8h-1a427420b6025d522bb7b3c652e8c2be48"><span class="std std-ref">trek_import_s</span></a><span></span><span class="p">(</span>
    <span class="kt">void</span> <span class="o">**</span><span class="n">data</span><span class="p">,</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="o">*</span><span class="n">status</span><span class="p">,</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">n</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">char</span> <span class="n">S_type</span><span class="p">[],</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">S_ne</span><span class="p">,</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">S_row</span><span class="p">[],</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">S_col</span><span class="p">[],</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">S_ptr</span><span class="p">[]</span>
<span class="p">);</span>

<span class="kt">void</span> <a class="reference internal" href="#doxid-galahad-trek-8h-1aae677e64bacb35354f49326815b694c3"><span class="std std-ref">trek_reset_control</span></a><span></span><span class="p">(</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-control-type"><span class="std std-ref">trek_control_type</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span>
    <span class="kt">void</span> <span class="o">**</span><span class="n">data</span><span class="p">,</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="o">*</span><span class="n">status</span>
<span class="p">);</span>

<span class="kt">void</span> <a class="reference internal" href="#doxid-galahad-trek-8h-1aadb8a751c29efcef663bf9560a1f9a8e"><span class="std std-ref">trek_solve_problem</span></a><span></span><span class="p">(</span>
    <span class="kt">void</span> <span class="o">**</span><span class="n">data</span><span class="p">,</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="o">*</span><span class="n">status</span><span class="p">,</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">n</span><span class="p">,</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">H_ne</span><span class="p">,</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">H_val</span><span class="p">[],</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">c</span><span class="p">[],</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">radius</span><span class="p">,</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">x</span><span class="p">[],</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">S_ne</span><span class="p">,</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">S_val</span><span class="p">[]</span>
<span class="p">);</span>

<span class="kt">void</span> <a class="reference internal" href="#doxid-galahad-trek-8h-1a3dda24010e564e2d6536cc7ea518451e"><span class="std std-ref">trek_information</span></a><span></span><span class="p">(</span><span class="kt">void</span> <span class="o">**</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-inform-type"><span class="std std-ref">trek_inform_type</span></a><span></span><span class="o">*</span> <span class="n">inform</span><span class="p">,</span> <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="o">*</span><span class="n">status</span><span class="p">);</span>

<span class="kt">void</span> <a class="reference internal" href="#doxid-galahad-trek-8h-1ab5cf0077db0631814fdd03599a585376"><span class="std std-ref">trek_terminate</span></a><span></span><span class="p">(</span>
    <span class="kt">void</span> <span class="o">**</span><span class="n">data</span><span class="p">,</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-control-type"><span class="std std-ref">trek_control_type</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-inform-type"><span class="std std-ref">trek_inform_type</span></a><span></span><span class="o">*</span> <span class="n">inform</span>
<span class="p">);</span></pre>
</section>
<section id="typedefs">
<span id="details-global"></span><h2>typedefs<a class="headerlink" href="#typedefs" title="Link to this heading">#</a></h2>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-spc-8h"><span id="index-0"></span><span></span><span class="k">typedef</span> <span class="kt">float</span> <span class="n">spc_</span></pre>
<p><code class="docutils literal notranslate"><span class="pre">spc_</span></code> is real single precision</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-rpc-8h"><span id="index-1"></span><span></span><span class="k">typedef</span> <span class="kt">double</span> <span class="n">rpc_</span></pre>
<p><code class="docutils literal notranslate"><span class="pre">rpc_</span></code> is the real working precision used, but may be changed to <code class="docutils literal notranslate"><span class="pre">float</span></code> by
defining the  preprocessor variable <code class="docutils literal notranslate"><span class="pre">REAL_32</span></code> or (if supported) to
<code class="docutils literal notranslate"><span class="pre">__real128</span></code> using the variable <code class="docutils literal notranslate"><span class="pre">REAL_128</span></code>.</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-ipc-8h"><span id="index-2"></span><span></span><span class="k">typedef</span> <span class="kt">int</span> <span class="n">ipc_</span></pre>
<p><code class="docutils literal notranslate"><span class="pre">ipc_</span></code> is the default integer word length used, but may be changed to
<code class="docutils literal notranslate"><span class="pre">int64_t</span></code> by defining the  preprocessor variable <code class="docutils literal notranslate"><span class="pre">INTEGER_64</span></code>.</p>
</section>
<section id="function-and-structure-names">
<h2>function and structure names<a class="headerlink" href="#function-and-structure-names" title="Link to this heading">#</a></h2>
<p>The function and structure names described below are appropriate for the
default real working precision (<code class="docutils literal notranslate"><span class="pre">double</span></code>) and integer word length
(<code class="docutils literal notranslate"><span class="pre">int32_t</span></code>). To use the functions and structures with different precisions
and integer word lengths, an additional suffix must be added to their names
(and the arguments set accordingly). The appropriate suffices are:</p>
<p><code class="docutils literal notranslate"><span class="pre">_s</span></code> for single precision (<code class="docutils literal notranslate"><span class="pre">float</span></code>) reals and
standard 32-bit (<code class="docutils literal notranslate"><span class="pre">int32_t</span></code>) integers;</p>
<p><code class="docutils literal notranslate"><span class="pre">_q</span></code> for quadruple precision (<code class="docutils literal notranslate"><span class="pre">__real128</span></code>) reals (if supported) and
standard 32-bit (<code class="docutils literal notranslate"><span class="pre">int32_t</span></code>) integers;</p>
<p><code class="docutils literal notranslate"><span class="pre">_64</span></code> for standard precision (<code class="docutils literal notranslate"><span class="pre">double</span></code>) reals and
64-bit (<code class="docutils literal notranslate"><span class="pre">int64_t</span></code>) integers;</p>
<p><code class="docutils literal notranslate"><span class="pre">_s_64</span></code> for single precision (<code class="docutils literal notranslate"><span class="pre">float</span></code>) reals and
64-bit (<code class="docutils literal notranslate"><span class="pre">int64_t</span></code>) integers; and</p>
<p><code class="docutils literal notranslate"><span class="pre">_q_64</span></code> for quadruple precision (<code class="docutils literal notranslate"><span class="pre">__real128</span></code>) reals (if supported) and
64-bit (<code class="docutils literal notranslate"><span class="pre">int64_t</span></code>) integers.</p>
<p>Thus a call to <code class="docutils literal notranslate"><span class="pre">trek_initialize</span></code> below will instead be</p>
<pre class="highlight doxyrest-title-code-block literal-block"><span></span><span class="kt">void</span> <span class="n">trek_initialize_s_64</span><span class="p">(</span><span class="kt">void</span> <span class="o">**</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-control-type"><span class="std std-ref">trek_control_type_s_64</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span>
                         <span class="kt">int64_t</span> <span class="o">*</span><span class="n">status</span><span class="p">)</span></pre>
<p>if single precision (<code class="docutils literal notranslate"><span class="pre">float</span></code>) reals and 64-bit (<code class="docutils literal notranslate"><span class="pre">int64_t</span></code>) integers are
required. Thus it is possible to call functions for this package
with more that one precision and/or integer word length at same time. An
<a class="reference internal" href="expo_multi.html#expo-multi-calls"><span class="std std-ref">example</span></a> is provided for the package <code class="docutils literal notranslate"><span class="pre">expo</span></code>,
and the obvious modifications apply equally here.</p>
</section>
<section id="function-calls">
<h2>function calls<a class="headerlink" href="#function-calls" title="Link to this heading">#</a></h2>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-trek-8h-1acb066d992c4ec394402bc7b7317e1163"><span id="index-3"></span><span></span><span class="kt">void</span> <span class="n">trek_initialize</span><span class="p">(</span><span class="kt">void</span> <span class="o">**</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-control-type"><span class="std std-ref">trek_control_type</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span> <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="o">*</span><span class="n">status</span><span class="p">)</span></pre>
<p>Set default control values and initialize private data</p>
<p class="rubric">Parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>control</p></td>
<td><p>is a struct containing control information (see <a class="reference internal" href="#doxid-structtrek-control-type"><span class="std std-ref">trek_control_type</span></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>is a scalar variable of type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that gives the exit status from the package. Possible values are (currently):</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>0</strong></dt><dd><p>The initialization was successful.</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-trek-8h-1adc7c56e7be2f7cc9d32921582d379b13"><span id="index-4"></span><span></span><span class="kt">void</span> <span class="n">trek_read_specfile</span><span class="p">(</span><span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-control-type"><span class="std std-ref">trek_control_type</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="n">specfile</span><span class="p">[])</span></pre>
<p>Read the content of a specification file, and assign values
associated with given keywords to the corresponding control
parameters. An in-depth discussion of specification files is
<a class="reference internal" href="spec.html#details-spec-file"><span class="std std-ref">available</span></a>, and a detailed list
of keywords with associated default values is provided in
$GALAHAD/src/trek/TREK.template.
See also Table 2.1 in the Fortran documentation provided in
$GALAHAD/doc/trek.pdf for a list of how these keywords
relate to the components of the control structure.</p>
<p class="rubric">Parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>control</p></td>
<td><p>is a struct containing control information (see <a class="reference internal" href="#doxid-structtrek-control-type"><span class="std std-ref">trek_control_type</span></a>)</p></td>
</tr>
<tr class="row-even"><td><p>specfile</p></td>
<td><p>is a character string containing the name of the specification file</p></td>
</tr>
</tbody>
</table>
</div>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-trek-8h-1a4becded30e9b95fe7028b7799292c0af"><span id="index-5"></span><span></span><span class="kt">void</span> <span class="n">trek_import</span><span class="p">(</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-control-type"><span class="std std-ref">trek_control_type</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span>
    <span class="kt">void</span> <span class="o">**</span><span class="n">data</span><span class="p">,</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="o">*</span><span class="n">status</span><span class="p">,</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">n</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">char</span> <span class="n">H_type</span><span class="p">[],</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">H_ne</span><span class="p">,</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">H_row</span><span class="p">[],</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">H_col</span><span class="p">[],</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">H_ptr</span><span class="p">[]</span>
<span class="p">)</span></pre>
<p>Import problem data into internal storage prior to solution.</p>
<p class="rubric">Parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>control</p></td>
<td><p>is a struct whose members provide control paramters for the remaining prcedures (see <a class="reference internal" href="#doxid-structtrek-control-type"><span class="std std-ref">trek_control_type</span></a>)</p></td>
</tr>
<tr class="row-even"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>is a scalar variable of type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that gives the exit status from the package. Possible values are:</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>0</strong></dt><dd><p>The import was successful</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-1</strong></dt><dd><p>An allocation error occurred. A message indicating
the offending array is written on unit
control.error, and the returned allocation status
and a string containing the name of the offending
array are held in inform.alloc_status and
inform.bad_alloc respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-2</strong></dt><dd><p>A deallocation error occurred. A message indicating
the offending array is written on unit control.error
and the returned allocation status and a string
containing the name of the offending array are held
in inform.alloc_status and inform.bad_alloc
respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-3</strong></dt><dd><p>The restrictions n &gt; 0 or requirement that
a type contains its relevant string ‘dense’,
‘coordinate’, ‘sparse_by_rows’, diagonal’,
‘scaled-identity’, ‘identity’, ‘zero’ or ‘none’  has been violated.</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>n</p></td>
<td><p>is a scalar variable of type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that holds the number of rows (and columns) of H.</p></td>
</tr>
<tr class="row-odd"><td><p>H_type</p></td>
<td><p>is a one-dimensional array of type char that specifies the <a class="reference internal" href="#details-trek-storage-sym"><span class="std std-ref">symmetric storage scheme</span></a> used for the Hessian, <span class="math notranslate nohighlight">\(H\)</span>. It should be one of ‘coordinate’, ‘sparse_by_rows’, ‘dense’, ‘diagonal’, ‘scaled-identity’, ‘identity’, ‘zero’ or ‘none’; lower or upper case variants are allowed.</p></td>
</tr>
<tr class="row-even"><td><p>H_ne</p></td>
<td><p>is a scalar variable of type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that holds the number of entries in the lower triangular part of <span class="math notranslate nohighlight">\(H\)</span> in the sparse co-ordinate storage scheme. It need not be set for any of the other schemes.</p></td>
</tr>
<tr class="row-odd"><td><p>H_row</p></td>
<td><p>is a one-dimensional array of size H_ne and type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that holds the row indices of the lower triangular part of <span class="math notranslate nohighlight">\(H\)</span> in the sparse co-ordinate storage scheme. It need not be set for any of the other three schemes, and in this case can be NULL.</p></td>
</tr>
<tr class="row-even"><td><p>H_col</p></td>
<td><p>is a one-dimensional array of size H_ne and type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that holds the column indices of the lower triangular part of <span class="math notranslate nohighlight">\(H\)</span> in either the sparse co-ordinate, or the sparse row-wise storage scheme. It need not be set when the dense or diagonal storage schemes are used, and in this case can be NULL.</p></td>
</tr>
<tr class="row-odd"><td><p>H_ptr</p></td>
<td><p>is a one-dimensional array of size n+1 and type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that holds the starting position of each row of the lower triangular part of <span class="math notranslate nohighlight">\(H\)</span>, as well as the total number of entries, in the sparse row-wise storage scheme. It need not be set when the other schemes are used, and in this case can be NULL.</p></td>
</tr>
</tbody>
</table>
</div>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-trek-8h-1a427420b6025d522bb7b3c652e8c2be48"><span id="index-6"></span><span></span><span class="kt">void</span> <span class="n">trek_import_s</span><span class="p">(</span>
    <span class="kt">void</span> <span class="o">**</span><span class="n">data</span><span class="p">,</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="o">*</span><span class="n">status</span><span class="p">,</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">n</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">char</span> <span class="n">S_type</span><span class="p">[],</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">S_ne</span><span class="p">,</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">S_row</span><span class="p">[],</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">S_col</span><span class="p">[],</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">S_ptr</span><span class="p">[]</span>
<span class="p">)</span></pre>
<p>Import data for the scaling matrix <span class="math notranslate nohighlight">\(S\)</span> into internal storage prior to solution.</p>
<p class="rubric">Parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>status</p></td>
<td><p>is a scalar variable of type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that gives the exit status from the package. Possible values are:</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>0</strong></dt><dd><p>The import was successful</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-1</strong></dt><dd><p>An allocation error occurred. A message indicating
the offending array is written on unit
control.error, and the returned allocation status
and a string containing the name of the offending
array are held in inform.alloc_status and
inform.bad_alloc respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-2</strong></dt><dd><p>A deallocation error occurred. A message indicating
the offending array is written on unit control.error
and the returned allocation status and a string
containing the name of the offending array are held
in inform.alloc_status and inform.bad_alloc
respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-3</strong></dt><dd><p>The restriction n &gt; 0 or requirement that
a type contains its relevant string ‘dense’,
‘coordinate’, ‘sparse_by_rows’, diagonal’
‘scaled-identity’ or ‘identity’ has been violated.</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>n</p></td>
<td><p>is a scalar variable of type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that holds the number of rows (and columns) of M.</p></td>
</tr>
<tr class="row-even"><td><p>S_type</p></td>
<td><p>is a one-dimensional array of type char that specifies the <a class="reference internal" href="#details-trek-storage-sym"><span class="std std-ref">symmetric storage scheme</span></a> used for the scaling matrix, <span class="math notranslate nohighlight">\(S\)</span>. It should be one of ‘coordinate’, ‘sparse_by_rows’, ‘dense’, or ‘diagonal’; lower or upper case variants are allowed.</p></td>
</tr>
<tr class="row-odd"><td><p>S_ne</p></td>
<td><p>is a scalar variable of type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that holds the number of entries in the lower triangular part of <span class="math notranslate nohighlight">\(S\)</span> in the sparse co-ordinate storage scheme. It need not be set for any of the other schemes.</p></td>
</tr>
<tr class="row-even"><td><p>S_row</p></td>
<td><p>is a one-dimensional array of size S_ne and type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that holds the row indices of the lower triangular part of <span class="math notranslate nohighlight">\(S\)</span> in the sparse co-ordinate storage scheme. It need not be set for any of the other three schemes, and in this case can be NULL.</p></td>
</tr>
<tr class="row-odd"><td><p>S_col</p></td>
<td><p>is a one-dimensional array of size S_ne and type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that holds the column indices of the lower triangular part of <span class="math notranslate nohighlight">\(S\)</span> in either the sparse co-ordinate, or the sparse row-wise storage scheme. It need not be set when the dense, diagonal or identity storage schemes are used, and in this case can be NULL.</p></td>
</tr>
<tr class="row-even"><td><p>S_ptr</p></td>
<td><p>is a one-dimensional array of size n+1 and type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that holds the starting position of each row of the lower triangular part of <span class="math notranslate nohighlight">\(S\)</span>, as well as the total number of entries, in the sparse row-wise storage scheme. It need not be set when the other schemes are used, and in this case can be NULL.</p></td>
</tr>
</tbody>
</table>
</div>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-trek-8h-1aae677e64bacb35354f49326815b694c3"><span id="index-7"></span><span></span><span class="kt">void</span> <span class="n">trek_reset_control</span><span class="p">(</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-control-type"><span class="std std-ref">trek_control_type</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span>
    <span class="kt">void</span> <span class="o">**</span><span class="n">data</span><span class="p">,</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="o">*</span><span class="n">status</span>
<span class="p">)</span></pre>
<p>Reset control parameters after import if required.</p>
<p class="rubric">Parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>control</p></td>
<td><p>is a struct whose members provide control paramters for the remaining prcedures (see <a class="reference internal" href="#doxid-structtrek-control-type"><span class="std std-ref">trek_control_type</span></a>)</p></td>
</tr>
<tr class="row-even"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>is a scalar variable of type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that gives the exit status from the package. Possible values are:</p>
<ul class="simple">
<li><ol class="arabic simple" start="0">
<li><p>The import was successful.</p></li>
</ol>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-trek-8h-1aadb8a751c29efcef663bf9560a1f9a8e"><span id="index-8"></span><span></span><span class="kt">void</span> <span class="n">trek_solve_problem</span><span class="p">(</span>
    <span class="kt">void</span> <span class="o">**</span><span class="n">data</span><span class="p">,</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="o">*</span><span class="n">status</span><span class="p">,</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">n</span><span class="p">,</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">H_ne</span><span class="p">,</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">H_val</span><span class="p">[],</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">c</span><span class="p">[],</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">radius</span><span class="p">,</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">x</span><span class="p">[],</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">S_ne</span><span class="p">,</span>
    <span class="k">const</span> <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">S_val</span><span class="p">[]</span>
<span class="p">)</span></pre>
<p>Solve the trust-region subproblem.</p>
<p class="rubric">Parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>status</p></td>
<td><p>is a scalar variable of type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that gives the entry and exit status from the package.</p>
<p>On initial entry, status must be set to 1.</p>
<p>Possible exit values are:</p>
<ul>
<li><dl class="simple">
<dt><strong>0</strong></dt><dd><p>The run was successful.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-1</strong></dt><dd><p>An allocation error occurred. A message indicating
the offending array is written on unit
control.error, and the returned allocation status
and a string containing the name of the offending
array are held in inform.alloc_status and
inform.bad_alloc respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-2</strong></dt><dd><p>A deallocation error occurred. A message indicating
the offending array is written on unit control.error
and the returned allocation status and a string
containing the name of the offending array are held
in inform.alloc_status and inform.bad_alloc
respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-3</strong></dt><dd><p>The restrictions n &gt; 0 or radius &gt; 0, or
requirement that a type contains its relevant string
‘dense’, ‘coordinate’, ‘sparse_by_rows’, ‘diagonal’,
‘scaled_identity’, ‘identity’ or ‘none’ has been violated.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-9</strong></dt><dd><p>The analysis phase of the factorization of the
matrix <span class="math notranslate nohighlight">\(H\)</span> or <span class="math notranslate nohighlight">\(S\)</span> failed.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-10</strong></dt><dd><p>The factorization of the matrix <span class="math notranslate nohighlight">\(H\)</span> or <span class="math notranslate nohighlight">\(S\)</span> failed.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-11</strong></dt><dd><p>A solve involving the matrix <span class="math notranslate nohighlight">\(H\)</span> or <span class="math notranslate nohighlight">\(S\)</span> failed.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-15</strong></dt><dd><p>The matrix <span class="math notranslate nohighlight">\(S\)</span> appears not to be diagonally dominant.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-16</strong></dt><dd><p>The problem is so ill-conditioned that further
progress is impossible.</p>
</dd>
</dl>
</li>
<li><dl>
<dt><strong>-18</strong></dt><dd><blockquote>
<div><p>Too many iterations have been required. This may happen if
control.eks max is too small, but may also be symptomatic
of a badly scaled problem.</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>-31</strong>
A resolve call has been made before an initial call
(see control.new_radius and control.new_values).</p></li>
<li><p><strong>-38</strong>
An error occurred in a call to an LAPACK subroutine.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>n</p></td>
<td><p>is a scalar variable of type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that holds the number of variables</p></td>
</tr>
<tr class="row-even"><td><p>H_ne</p></td>
<td><p>is a scalar variable of type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that holds the number of entries in the lower triangular part of the Hessian matrix <span class="math notranslate nohighlight">\(H\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>H_val</p></td>
<td><p>is a one-dimensional array of size h_ne and type <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a>, that holds the values of the entries of the lower triangular part of the Hessian matrix <span class="math notranslate nohighlight">\(H\)</span> in any of the available storage schemes.</p></td>
</tr>
<tr class="row-even"><td><p>c</p></td>
<td><p>is a one-dimensional array of size n and type <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a>, that holds the linear term <span class="math notranslate nohighlight">\(c\)</span> of the objective function. The j-th component of c, j = 0, … , n-1, contains <span class="math notranslate nohighlight">\(c_j\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>radius</p></td>
<td><p>is a scalar of type <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a>, that holds the trust-region radius, <span class="math notranslate nohighlight">\(\Delta\)</span>, used. radius must be strictly positive</p></td>
</tr>
<tr class="row-even"><td><p>x</p></td>
<td><p>is a one-dimensional array of size n and type <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a>, that holds the values <span class="math notranslate nohighlight">\(x\)</span> of the optimization variables. The j-th component of x, j = 0, … , n-1, contains <span class="math notranslate nohighlight">\(x_j\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>S_ne</p></td>
<td><p>is a scalar variable of type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that holds the number of entries in the scaling matrix <span class="math notranslate nohighlight">\(S\)</span> if it not the identity matrix.</p></td>
</tr>
<tr class="row-even"><td><p>S_val</p></td>
<td><p>is a one-dimensional array of size S_ne and type <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a>, that holds the values of the entries of the scaling matrix <span class="math notranslate nohighlight">\(S\)</span>, if it is not the identity matrix, in any of the available storage schemes. If S_val is NULL, <span class="math notranslate nohighlight">\(S\)</span> will be taken to be the identity matrix.</p></td>
</tr>
</tbody>
</table>
</div>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-trek-8h-1a3dda24010e564e2d6536cc7ea518451e"><span id="index-9"></span><span></span><span class="kt">void</span> <span class="n">trek_information</span><span class="p">(</span><span class="kt">void</span> <span class="o">**</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-inform-type"><span class="std std-ref">trek_inform_type</span></a><span></span><span class="o">*</span> <span class="n">inform</span><span class="p">,</span> <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="o">*</span><span class="n">status</span><span class="p">)</span></pre>
<p>Provides output information</p>
<p class="rubric">Parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>inform</p></td>
<td><p>is a struct containing output information (see <a class="reference internal" href="#doxid-structtrek-inform-type"><span class="std std-ref">trek_inform_type</span></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>is a scalar variable of type <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a>, that gives the exit status from the package. Possible values are (currently):</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>0</strong></dt><dd><p>The values were recorded successfully</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-trek-8h-1ab5cf0077db0631814fdd03599a585376"><span id="index-10"></span><span></span><span class="kt">void</span> <span class="n">trek_terminate</span><span class="p">(</span>
    <span class="kt">void</span> <span class="o">**</span><span class="n">data</span><span class="p">,</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-control-type"><span class="std std-ref">trek_control_type</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-inform-type"><span class="std std-ref">trek_inform_type</span></a><span></span><span class="o">*</span> <span class="n">inform</span>
<span class="p">)</span></pre>
<p>Deallocate all internal private storage</p>
<p class="rubric">Parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>control</p></td>
<td><p>is a struct containing control information (see <a class="reference internal" href="#doxid-structtrek-control-type"><span class="std std-ref">trek_control_type</span></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>inform</p></td>
<td><p>is a struct containing output information (see <a class="reference internal" href="#doxid-structtrek-inform-type"><span class="std std-ref">trek_inform_type</span></a>)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="available-structures">
<h2>available structures<a class="headerlink" href="#available-structures" title="Link to this heading">#</a></h2>
</section>
<section id="trek-control-type-structure">
<span id="doxid-structtrek-control-type"></span><span id="index-11"></span><h2>trek_control_type structure<a class="headerlink" href="#trek-control-type-structure" title="Link to this heading">#</a></h2>
<div class="toctree-wrapper compound">
</div>
<pre class="highlight doxyrest-overview-code-block literal-block"><span></span><span class="cp">#include</span> <span class="cpf">&lt;galahad_trek.h&gt;</span>

<span class="k">struct</span> <span class="n">trek_control_type</span> <span class="p">{</span>
    <span class="c1">// fields</span>

    <span class="kt">bool</span> <a class="reference internal" href="#doxid-structtrek-control-type-f-indexing"><span class="std std-ref">f_indexing</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-control-type-error"><span class="std std-ref">error</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-control-type-out"><span class="std std-ref">out</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-control-type-print-level"><span class="std std-ref">print_level</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-control-type-eks-max"><span class="std std-ref">eks_max</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-control-type-it-max"><span class="std std-ref">it_max</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-control-type-f"><span class="std std-ref">f</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-control-type-reduction"><span class="std std-ref">reduction</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-control-type-stop-residual"><span class="std std-ref">stop_residual</span></a><span></span><span class="p">;</span>
    <span class="kt">bool</span> <a class="reference internal" href="#doxid-structtrek-control-type-reorthogonalize"><span class="std std-ref">reorthogonalize</span></a><span></span><span class="p">;</span>
    <span class="kt">bool</span> <a class="reference internal" href="#doxid-structtrek-control-type-s-version-52"><span class="std std-ref">s_version_52</span></a><span></span><span class="p">;</span>
    <span class="kt">bool</span> <a class="reference internal" href="#doxid-structtrek-control-type-perturb-c"><span class="std std-ref">perturb_c</span></a><span></span><span class="p">;</span>
    <span class="kt">bool</span> <a class="reference internal" href="#doxid-structtrek-control-type-stop-check-all-orders"><span class="std std-ref">stop_check_all_orders</span></a><span></span><span class="p">;</span>
    <span class="kt">bool</span> <a class="reference internal" href="#doxid-structtrek-control-type-new-radius"><span class="std std-ref">new_radius</span></a><span></span><span class="p">;</span>
    <span class="kt">bool</span> <a class="reference internal" href="#doxid-structtrek-control-type-new-values"><span class="std std-ref">new_values</span></a><span></span><span class="p">;</span>
    <span class="kt">bool</span> <a class="reference internal" href="#doxid-structtrek-control-type-space-critical"><span class="std std-ref">space_critical</span></a><span></span><span class="p">;</span>
    <span class="kt">bool</span> <a class="reference internal" href="#doxid-structtrek-control-type-deallocate-error-fatal"><span class="std std-ref">deallocate_error_fatal</span></a><span></span><span class="p">;</span>
    <span class="kt">char</span> <a class="reference internal" href="#doxid-structtrek-control-type-linear-solver"><span class="std std-ref">linear_solver</span></a><span></span><span class="p">[</span><span class="mi">31</span><span class="p">];</span>
    <span class="kt">char</span> <a class="reference internal" href="#doxid-structtrek-control-type-linear-solver-for-s"><span class="std std-ref">linear_solver_for_s</span></a><span></span><span class="p">[</span><span class="mi">31</span><span class="p">];</span>
    <span class="kt">char</span> <a class="reference internal" href="#doxid-structtrek-control-type-prefix"><span class="std std-ref">prefix</span></a><span></span><span class="p">[</span><span class="mi">31</span><span class="p">];</span>
    <span class="k">struct</span> <a class="reference internal" href="sls.html#doxid-structsls-control-type"><span class="std std-ref">sls_control_type</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-control-type-sls-control"><span class="std std-ref">sls_control</span></a><span></span><span class="p">;</span>
    <span class="k">struct</span> <a class="reference internal" href="sls.html#doxid-structsls-control-type"><span class="std std-ref">sls_control_type</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-control-type-sls-s-control"><span class="std std-ref">sls_s_control</span></a><span></span><span class="p">;</span>
    <span class="k">struct</span> <a class="reference internal" href="trs.html#doxid-structtrs-control-type"><span class="std std-ref">trs_control_type</span></a><span></span> trs_control<span></span><span class="p">;</span>
<span class="p">};</span></pre>
</section>
<section id="detailed-documentation">
<span id="details-structtrek-control-type"></span><h2>detailed documentation<a class="headerlink" href="#detailed-documentation" title="Link to this heading">#</a></h2>
<p>control derived type as a C struct</p>
<section id="components">
<h3>components<a class="headerlink" href="#components" title="Link to this heading">#</a></h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-f-indexing"><span id="index-12"></span><span></span><span class="kt">bool</span> <span class="n">f_indexing</span></pre>
<p>use C or Fortran sparse matrix indexing</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-error"><span id="index-13"></span><a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">error</span></pre>
<p>unit for error messages</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-out"><span id="index-14"></span><a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">out</span></pre>
<p>unit for monitor output</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-print-level"><span id="index-15"></span><a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">print_level</span></pre>
<p>controls level of diagnostic output</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-eks-max"><span id="index-16"></span><a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">eks_max</span></pre>
<p>maximum dimension of the extended Krylov space employed. If a negative value is given, the value 100 will be used instead</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-it-max"><span id="index-17"></span><a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">it_max</span></pre>
<p>the maximum number of iterations allowed.  If a negative value is given, the value 100 will be used instead</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-f"><span id="index-18"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">f</span></pre>
<p>the value of <span class="math notranslate nohighlight">\(f\)</span> in the objective function. This value has no effect on the computed <span class="math notranslate nohighlight">\(x\)</span>, and takes the value 0.0 by default</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-reduction"><span id="index-19"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">reduction</span></pre>
<p>the value of the reduction factor for a suggested subsequent trust-region radius, see control[‘next_radius’]. The suggested radius will be <code class="docutils literal notranslate"><span class="pre">reduction</span></code> times the smaller of the current radius and <span class="math notranslate nohighlight">\(\|x\|_S\)</span> at the output <span class="math notranslate nohighlight">\(x\)</span>.</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-stop-residual"><span id="index-20"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">stop_residual</span></pre>
<p>the value of the stopping tolerance used by the algorithm. The iteration stops as soon as <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(\lambda\)</span> are found to satisfy <span class="math notranslate nohighlight">\(\| ( H + \lambda S ) x + c \| &lt;\)</span> <code class="docutils literal notranslate"><span class="pre">stop_residual</span></code> <span class="math notranslate nohighlight">\(\times \max( 1, \|c\| )\)</span>.</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-reorthogonalize"><span id="index-21"></span><span></span><span class="kt">bool</span> <span class="n">reorthogonalize</span></pre>
<p>should be set to true if the generated basis of the extended-Krylov subspace is to be reorthogonalized at every iteration. This can be very expensive, and is generally not warranted</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-s-version-52"><span id="index-22"></span><span></span><span class="kt">bool</span> <span class="n">s_version_52</span></pre>
<p>should be set to true if Algorithm 5.2 in the paper is used to generate the extended Krylov space recurrences when a non-unit <span class="math notranslate nohighlight">\(S\)</span> is given, and false if those from Algorithm B.3 ares used instead. In practice, there is very little difference in performance and accuracy</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-perturb-c"><span id="index-23"></span><span></span><span class="kt">bool</span> <span class="n">perturb_c</span></pre>
<p>should be set to true if the user wishes to make a tiny pseudo-random perturbations to the components of the term <span class="math notranslate nohighlight">\(c\)</span> to try to protect from the so-called (probability zero) “hard” case. Perturbations are generally not needed, and should only be used in very exceptional cases</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-stop-check-all-orders"><span id="index-24"></span><span></span><span class="kt">bool</span> <span class="n">stop_check_all_orders</span></pre>
<p>should be set to true if the algorithm checks for termination for each new member of the extended Krylov space. Such checks incur some extra cost, and experience shows that testing every second member is sufficient</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-new-radius"><span id="index-25"></span><span></span><span class="kt">bool</span> <span class="n">new_radius</span></pre>
<p>should be set to true if the call retains the previous <span class="math notranslate nohighlight">\(H\)</span>, <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(c\)</span>, but with a new, smaller radius</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-new-values"><span id="index-26"></span><span></span><span class="kt">bool</span> <span class="n">new_values</span></pre>
<p>should be set to true if the any of the values of <span class="math notranslate nohighlight">\(H\)</span>, <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(c\)</span> has changed since a previous call</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-space-critical"><span id="index-27"></span><span></span><span class="kt">bool</span> <span class="n">space_critical</span></pre>
<p>if space is critical, ensure allocated arrays are no bigger than needed</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-deallocate-error-fatal"><span id="index-28"></span><span></span><span class="kt">bool</span> <span class="n">deallocate_error_fatal</span></pre>
<p>exit if any deallocation fails</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-linear-solver"><span id="index-29"></span><span></span><span class="kt">char</span> <span class="n">linear_solver</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span></pre>
<p>the name of the linear equation solver used to solve any symmetric positive-definite linear system involving <span class="math notranslate nohighlight">\(H\)</span> that might arise. Possible choices are currently: ‘sils’, ‘ma27’, ‘ma57’, ‘ma77’, ‘ma86’, ‘ma87’, ‘ma97’, ssids, ‘pardiso’, ‘wsmp’, ‘sytr’, ‘potr’ and ‘pbtr’ although only ‘sytr’, ‘potr’, ‘pbtr’ and, for OMP 4.0-compliant compilers, ‘ssids’ are installed by default; others are easily installed (see README.external). More details of the capabilities of each solver are provided in the documentation for <a class="reference internal" href="sls.html#details-sls-solvers"><span class="std std-ref">galahad_sls</span></a>.</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-linear-solver-for-s"><span id="index-30"></span><span></span><span class="kt">char</span> <span class="n">linear_solver_for_s</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span></pre>
<p>the name of the linear equation solver used to solve any symmetric positive-definite linear system involving the optional <span class="math notranslate nohighlight">\(S\)</span> that might arise. Possible choices are currently: ‘sils’, ‘ma27’, ‘ma57’, ‘ma77’, ‘ma86’, ‘ma87’, ‘ma97’, ssids, ‘pardiso’, ‘wsmp’, ‘sytr’, ‘potr’ and ‘pbtr’ although only ‘sytr’, ‘potr’, ‘pbtr’ and, for OMP 4.0-compliant compilers, ‘ssids’ are installed by default; others are easily installed (see README.external). More details of the capabilities of each solver are provided in the documentation for <a class="reference internal" href="sls.html#details-sls-solvers"><span class="std std-ref">galahad_sls</span></a>.</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-prefix"><span id="index-31"></span><span></span><span class="kt">char</span> <span class="n">prefix</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span></pre>
<p>all output lines will be prefixed by prefix(2:LEN(TRIM(.prefix))-1) where prefix contains the required string enclosed in quotes, e.g. “string” or ‘string’</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-sls-control"><span id="index-32"></span><span></span><span class="k">struct</span> <a class="reference internal" href="sls.html#doxid-structsls-control-type"><span class="std std-ref">sls_control_type</span></a><span></span> <span class="n">sls_control</span></pre>
<p>control parameters for the Cholesky factorization and solution (see sls_c documentation)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-sls-s-control"><span id="index-33"></span><span></span><span class="k">struct</span> <a class="reference internal" href="sls.html#doxid-structsls-control-type"><span class="std std-ref">sls_control_type</span></a><span></span> <span class="n">sls_s_control</span></pre>
<p>control parameters for the Cholesky factorization and solution when applied to <span class="math notranslate nohighlight">\(S\)</span> (see sls_c documentation)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-control-type-ir-control"><span id="index-34"></span><span></span><span class="k">struct</span> <a class="reference internal" href="ir.html#doxid-structir-control-type"><span class="std std-ref">ir_control_type</span></a><span></span> <span class="n">ir_control</span></pre>
<p>control parameters for iterative refinement (see ir_c documentation)</p>
</section>
</section>
<section id="trek-time-type-structure">
<span id="doxid-structtrek-time-type"></span><span id="index-35"></span><h2>trek_time_type structure<a class="headerlink" href="#trek-time-type-structure" title="Link to this heading">#</a></h2>
<div class="toctree-wrapper compound">
</div>
<pre class="highlight doxyrest-overview-code-block literal-block"><span></span><span class="cp">#include</span> <span class="cpf">&lt;galahad_trek.h&gt;</span>

<span class="k">struct</span> <span class="n">trek_time_type</span> <span class="p">{</span>
    <span class="c1">// fields</span>

    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-time-type-total"><span class="std std-ref">total</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-time-type-assemble"><span class="std std-ref">assemble</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-time-type-analyse"><span class="std std-ref">analyse</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-time-type-factorize"><span class="std std-ref">factorize</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-time-type-solve"><span class="std std-ref">solve</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-time-type-clock-total"><span class="std std-ref">clock_total</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-time-type-clock-assemble"><span class="std std-ref">clock_assemble</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-time-type-clock-analyse"><span class="std std-ref">clock_analyse</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-time-type-clock-factorize"><span class="std std-ref">clock_factorize</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-time-type-clock-solve"><span class="std std-ref">clock_solve</span></a><span></span><span class="p">;</span>
<span class="p">};</span></pre>
</section>
<section id="details-structtrek-time-type">
<span id="id1"></span><h2>detailed documentation<a class="headerlink" href="#details-structtrek-time-type" title="Link to this heading">#</a></h2>
<p>time derived type as a C struct</p>
<section id="id2">
<h3>components<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-time-type-total"><span id="index-36"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">total</span></pre>
<p>total CPU time spent in the package</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-time-type-assemble"><span id="index-37"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">assemble</span></pre>
<p>CPU time spent building <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(S\)</span>.</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-time-type-analyse"><span id="index-38"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">analyse</span></pre>
<p>CPU time spent reordering <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(S\)</span> prior to factorization.</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-time-type-factorize"><span id="index-39"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">factorize</span></pre>
<p>CPU time spent factorizing <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(S\)</span>.</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-time-type-solve"><span id="index-40"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">solve</span></pre>
<p>CPU time spent solving linear systems inolving <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(S\)</span>.</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-time-type-clock-total"><span id="index-41"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">clock_total</span></pre>
<p>total clock time spent in the package</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-time-type-clock-assemble"><span id="index-42"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">clock_assemble</span></pre>
<p>clock time spent building <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(S\)</span></p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-time-type-clock-analyse"><span id="index-43"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">clock_analyse</span></pre>
<p>clock time spent reordering <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(S\)</span> prior to factorization</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-time-type-clock-factorize"><span id="index-44"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">clock_factorize</span></pre>
<p>clock time spent factorizing <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(S\)</span></p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-time-type-clock-solve"><span id="index-45"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">clock_solve</span></pre>
<p>clock time spent solving linear systems inolving <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(S\)</span></p>
</section>
</section>
<section id="trek-inform-type-structure">
<span id="doxid-structtrek-inform-type"></span><span id="index-46"></span><h2>trek_inform_type structure<a class="headerlink" href="#trek-inform-type-structure" title="Link to this heading">#</a></h2>
<div class="toctree-wrapper compound">
</div>
<pre class="highlight doxyrest-overview-code-block literal-block"><span></span><span class="cp">#include</span> <span class="cpf">&lt;galahad_trek.h&gt;</span>

<span class="k">struct</span> <span class="n">trek_inform_type</span> <span class="p">{</span>
    <span class="c1">// fields</span>

    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-inform-type-status"><span class="std std-ref">status</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-inform-type-alloc-status"><span class="std std-ref">alloc_status</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-inform-type-iter"><span class="std std-ref">iter</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-inform-type-n-vec"><span class="std std-ref">n_vec</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-inform-type-obj"><span class="std std-ref">obj</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-inform-type-x-norm"><span class="std std-ref">x_norm</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-inform-type-multiplier"><span class="std std-ref">multiplier</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-inform-type-radius"><span class="std std-ref">radius</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-inform-type-next-radius"><span class="std std-ref">next_radius</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-inform-type-error"><span class="std std-ref">error</span></a><span></span><span class="p">;</span>
    <span class="kt">char</span> <a class="reference internal" href="#doxid-structtrek-inform-type-bad-alloc"><span class="std std-ref">bad_alloc</span></a><span></span><span class="p">[</span><span class="mi">81</span><span class="p">];</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-time-type"><span class="std std-ref">trek_time_type</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-inform-type-time"><span class="std std-ref">time</span></a><span></span><span class="p">;</span>
    <span class="k">struct</span> <a class="reference internal" href="struct_sls_inform_type.html#doxid-structsls-inform-type"><span class="std std-ref">sls_inform_type</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-inform-type-sls-inform"><span class="std std-ref">sls_inform</span></a><span></span><span class="p">;</span>
    <span class="k">struct</span> <a class="reference internal" href="struct_sls_inform_type.html#doxid-structsls-inform-type"><span class="std std-ref">sls_inform_type</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-inform-type-sls-s-inform"><span class="std std-ref">sls_s_inform</span></a><span></span><span class="p">;</span>
    <span class="k">struct</span> <a class="reference internal" href="trs.html#doxid-structtrs-inform-type"><span class="std std-ref">trs_inform_type</span></a><span></span> <a class="reference internal" href="#doxid-structtrek-inform-type-trs-inform"><span class="std std-ref">trs_inform</span></a><span></span><span class="p">;</span>
<span class="p">};</span></pre>
</section>
<section id="details-structtrek-inform-type">
<span id="id3"></span><h2>detailed documentation<a class="headerlink" href="#details-structtrek-inform-type" title="Link to this heading">#</a></h2>
<p>inform derived type as a C struct</p>
<section id="id4">
<h3>components<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-inform-type-status"><span id="index-47"></span><a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">status</span></pre>
<p>reported return status:</p>
<ul>
<li><p><strong>0</strong></p>
<p>the solution has been found</p>
</li>
<li><p><strong>-1</strong></p>
<p>an array allocation has failed</p>
</li>
<li><p><strong>-2</strong></p>
<p>an array deallocation has failed</p>
</li>
<li><p><strong>-3</strong></p>
<p>n and/or <span class="math notranslate nohighlight">\(\Delta\)</span> is not positive, or the requirement that type contains its relevant string ‘dense’, ‘coordinate’, ‘sparse_by_rows’, ‘diagonal’, ‘scaled_identity’,  ‘identity’, ‘zero’ or ‘none’ has been violated.</p>
</li>
<li><p><strong>-9</strong></p>
<p>the analysis phase of the factorization failed; the return status from the factorization package is given by inform.sls_inform.status or inform.sls_s_inform.status as appropriate</p>
</li>
<li><p><strong>-10</strong></p>
<p>the factorization failed; the return status from the factorization package is given by inform.sls_inform.status or inform.sls_s_inform.status as appropriate</p>
</li>
<li><p><strong>-11</strong></p>
<p>the solution of a set of linear equations using factors from the factorization package failed; the return status from the factorization package is given by inform.sls_inform.status or inform.sls_s_inform.status as appropriate</p>
</li>
<li><p><strong>-15</strong></p>
<p><span class="math notranslate nohighlight">\(S\)</span> does not appear to be strictly diagonally dominant</p>
</li>
<li><p><strong>-16</strong></p>
<p>ill-conditioning has prevented further progress</p>
</li>
<li><p><strong>-18</strong></p>
<p>too many iterations have been required. This may happen if control.eks max is too small, but may also be symptomatic of  a badly scaled problem.</p>
</li>
<li><p><strong>-31</strong></p>
<p>a resolve call has been made before an initial call (see control.new_radius and control.new_values)</p>
</li>
<li><p><strong>-38</strong></p>
<p>an error occurred in a call to an LAPACK subroutine</p>
</li>
</ul>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-inform-type-alloc-status"><span id="index-48"></span><a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">alloc_status</span></pre>
<p>STAT value after allocate failure</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-inform-type-iter"><span id="index-49"></span><a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">iter</span></pre>
<p>the total number of iterations required</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-inform-type-n-vec"><span id="index-50"></span><a class="reference internal" href="#doxid-galahad-ipc-8h"><span class="std std-ref">ipc_</span></a><span></span> <span class="n">n_vec</span></pre>
<p>the number of orthogonal vectors required (the dimension of the extended-Krylov subspace)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-inform-type-obj"><span id="index-51"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">obj</span></pre>
<p>the value of the quadratic function</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-inform-type-x-norm"><span id="index-52"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">x_norm</span></pre>
<p>the <span class="math notranslate nohighlight">\(S\)</span> -norm of <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(||x||_S\)</span></p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-inform-type-multiplier"><span id="index-53"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">multiplier</span></pre>
<p>the Lagrange multiplier corresponding to the trust-region constraint</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-inform-type-radius"><span id="index-54"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">radius</span></pre>
<p>the value of the current radius</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-inform-type-next-radius"><span id="index-55"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">next_radius</span></pre>
<p>the value of the the proposed next radius to be used if the current radius proves to be too large (see inform.reduction).</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-inform-type-error"><span id="index-56"></span><a class="reference internal" href="#doxid-galahad-rpc-8h"><span class="std std-ref">rpc_</span></a><span></span> <span class="n">error</span></pre>
<p>the value of the norm of the maximum relative residual error, <span class="math notranslate nohighlight">\(\|(H+\lambda S) x + c\|/\max(1,\|c\|)\)</span></p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-inform-type-bad-alloc"><span id="index-57"></span><span></span><span class="kt">char</span> <span class="n">bad_alloc</span><span class="p">[</span><span class="mi">81</span><span class="p">]</span></pre>
<p>name of array that provoked an allocate failure</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-inform-type-time"><span id="index-58"></span><span></span><span class="k">struct</span> <a class="reference internal" href="#doxid-structtrek-time-type"><span class="std std-ref">trek_time_type</span></a><span></span> <span class="n">time</span></pre>
<p>time information</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-inform-type-sls-inform"><span id="index-59"></span><span></span><span class="k">struct</span> <a class="reference internal" href="struct_sls_inform_type.html#doxid-structsls-inform-type"><span class="std std-ref">sls_inform_type</span></a><span></span> <span class="n">sls_inform</span></pre>
<p>Cholesky information for factorization and solves with <span class="math notranslate nohighlight">\(H\)</span> (see sls_c documentation)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-inform-type-sls-s-inform"><span id="index-60"></span><span></span><span class="k">struct</span> <a class="reference internal" href="struct_sls_inform_type.html#doxid-structsls-inform-type"><span class="std std-ref">sls_inform_type</span></a><span></span> <span class="n">sls_s_inform</span></pre>
<p>Cholesky information for factorization and solves with <span class="math notranslate nohighlight">\(S\)</span> (see sls_c documentation)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structtrek-inform-type-trs-inform"><span id="index-61"></span><span></span><span class="k">struct</span> <a class="reference internal" href="trs.html#doxid-structtrs-inform-type"><span class="std std-ref">trs_inform_type</span></a><span></span> <span class="n">trs_inform</span></pre>
<p>iterative_refinement information (see trs_c documentation)</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></div>
</div>
</section>
</section>
<section id="example-calls">
<span id="doxid-index-trek-examples"></span><h2>example calls<a class="headerlink" href="#example-calls" title="Link to this heading">#</a></h2>
<p>This is an example of how to use the package to solve a trust-region subproblem;
the code is available in $GALAHAD/src/trek/C/trekt.c .
A variety of supported Hessian and constraint matrix storage formats are shown.</p>
<p>Notice that C-style indexing is used, and that this is flagged by setting
<code class="docutils literal notranslate"><span class="pre">control.f_indexing</span></code> to <code class="docutils literal notranslate"><span class="pre">false</span></code>. The floating-point type <code class="docutils literal notranslate"><span class="pre">rpc_</span></code>
is set in <code class="docutils literal notranslate"><span class="pre">galahad_precision.h</span></code> to <code class="docutils literal notranslate"><span class="pre">double</span></code> by default, but to <code class="docutils literal notranslate"><span class="pre">float</span></code>
if the preprocessor variable <code class="docutils literal notranslate"><span class="pre">SINGLE</span></code> is defined. Similarly, the integer
type <code class="docutils literal notranslate"><span class="pre">ipc_</span></code> from <code class="docutils literal notranslate"><span class="pre">galahad_precision.h</span></code> is set to <code class="docutils literal notranslate"><span class="pre">int</span></code> by default,
but to <code class="docutils literal notranslate"><span class="pre">int64_t</span></code> if the preprocessor variable <code class="docutils literal notranslate"><span class="pre">INTEGER_64</span></code> is defined.</p>
<pre class="code C literal-block"><code><span class="comment multiline">/* trekt.c */</span><span class="whitespace">
</span><span class="comment multiline">/* Full test for the TREK C interface using C sparse matrix indexing */</span><span class="whitespace">

</span><span class="comment preproc">#include</span><span class="whitespace"> </span><span class="comment preprocfile">&lt;stdio.h&gt;</span><span class="comment preproc">
#include</span><span class="whitespace"> </span><span class="comment preprocfile">&lt;string.h&gt;</span><span class="comment preproc">
#include</span><span class="whitespace"> </span><span class="comment preprocfile">&lt;math.h&gt;</span><span class="comment preproc">
#include</span><span class="whitespace"> </span><span class="comment preprocfile">&quot;galahad_precision.h&quot;</span><span class="comment preproc">
#include</span><span class="whitespace"> </span><span class="comment preprocfile">&quot;galahad_cfunctions.h&quot;</span><span class="comment preproc">
#include</span><span class="whitespace"> </span><span class="comment preprocfile">&quot;galahad_trek.h&quot;</span><span class="comment preproc">
#ifdef REAL_128
#include</span><span class="whitespace"> </span><span class="comment preprocfile">&lt;quadmath.h&gt;</span><span class="comment preproc">
#endif
</span><span class="whitespace">
</span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name function">main</span><span class="punctuation">(</span><span class="keyword type">void</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">

    </span><span class="comment single">// Derived types
</span><span class="whitespace">    </span><span class="keyword type">void</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">data</span><span class="punctuation">;</span><span class="whitespace">
    </span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">trek_control_type</span><span class="whitespace"> </span><span class="name">control</span><span class="punctuation">;</span><span class="whitespace">
    </span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">trek_inform_type</span><span class="whitespace"> </span><span class="name">inform</span><span class="punctuation">;</span><span class="whitespace">

    </span><span class="comment single">// Set problem data
</span><span class="whitespace">    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">n</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">3</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="comment single">// dimension of H
</span><span class="whitespace">    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">H_ne</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">4</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="comment single">// number of elements of H
</span><span class="whitespace">    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">S_ne</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">3</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="comment single">// number of elements of M
</span><span class="whitespace">    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">H_dense_ne</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">6</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="comment single">// number of elements of H
</span><span class="whitespace">    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">S_dense_ne</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">6</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="comment single">// number of elements of M
</span><span class="whitespace">    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">H_row</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">};</span><span class="whitespace"> </span><span class="comment single">// row indices, NB lower triangle
</span><span class="whitespace">    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">H_col</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">H_ptr</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">4</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">S_row</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">};</span><span class="whitespace"> </span><span class="comment single">// row indices, NB lower triangle
</span><span class="whitespace">    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">S_col</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">S_ptr</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">3</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">rpc_</span><span class="whitespace"> </span><span class="name">H_val</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number float">1.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">2.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">3.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">4.0</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">rpc_</span><span class="whitespace"> </span><span class="name">S_val</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number float">1.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">2.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">1.0</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">rpc_</span><span class="whitespace"> </span><span class="name">H_dense</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number float">1.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">0.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">2.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">4.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">0.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">3.0</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">rpc_</span><span class="whitespace"> </span><span class="name">S_dense</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number float">1.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">0.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">2.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">0.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">0.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">1.0</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">rpc_</span><span class="whitespace"> </span><span class="name">H_diag</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number float">1.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">0.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">2.0</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">rpc_</span><span class="whitespace"> </span><span class="name">S_diag</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number float">1.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">2.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">1.0</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">rpc_</span><span class="whitespace"> </span><span class="name">radius</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number float">1.0</span><span class="punctuation">;</span><span class="whitespace">
    </span><span class="name">rpc_</span><span class="whitespace"> </span><span class="name">c</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number float">0.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">2.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">0.0</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="name">st</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">' '</span><span class="punctuation">;</span><span class="whitespace">
    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">status</span><span class="punctuation">;</span><span class="whitespace">
    </span><span class="name">rpc_</span><span class="whitespace"> </span><span class="name">x</span><span class="punctuation">[</span><span class="name">n</span><span class="punctuation">];</span><span class="whitespace">
    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="name">sr</span><span class="punctuation">[</span><span class="literal number integer">3</span><span class="punctuation">];</span><span class="whitespace">

    </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot; C sparse matrix indexing</span><span class="literal string escape">\n\n</span><span class="literal string">&quot;</span><span class="punctuation">);</span><span class="whitespace">

    </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot; basic tests of storage formats</span><span class="literal string escape">\n\n</span><span class="literal string">&quot;</span><span class="punctuation">);</span><span class="whitespace">

    </span><span class="keyword">for</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">s_is</span><span class="operator">=</span><span class="literal number integer">0</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">&lt;=</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">s_is</span><span class="operator">++</span><span class="punctuation">){</span><span class="whitespace"> </span><span class="comment single">// include a scaling matrix?
</span><span class="whitespace">      </span><span class="keyword">for</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">storage_type</span><span class="operator">=</span><span class="literal number integer">1</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">storage_type</span><span class="whitespace"> </span><span class="operator">&lt;=</span><span class="whitespace"> </span><span class="literal number integer">4</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">storage_type</span><span class="operator">++</span><span class="punctuation">){</span><span class="whitespace">

        </span><span class="comment single">// Initialize TREK
</span><span class="whitespace">        </span><span class="name">trek_initialize</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">control</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">

        </span><span class="comment single">// Set user-defined control options
</span><span class="whitespace">        </span><span class="name">control</span><span class="punctuation">.</span><span class="name">f_indexing</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name builtin">false</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="comment single">// C sparse matrix indexing
</span><span class="whitespace">
        </span><span class="keyword">switch</span><span class="punctuation">(</span><span class="name">storage_type</span><span class="punctuation">){</span><span class="whitespace">
            </span><span class="keyword">case</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="comment single">// sparse co-ordinate storage
</span><span class="whitespace">                </span><span class="name">st</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'C'</span><span class="punctuation">;</span><span class="whitespace">
                </span><span class="comment single">// import the control parameters and structural data
</span><span class="whitespace">                </span><span class="name">trek_import</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">control</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                             </span><span class="literal string">&quot;coordinate&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_row</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_col</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                  </span><span class="name">trek_s_import</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                </span><span class="literal string">&quot;coordinate&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_row</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_col</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                </span><span class="punctuation">}</span><span class="whitespace">
                </span><span class="keyword">break</span><span class="punctuation">;</span><span class="whitespace">
            </span><span class="keyword">case</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="comment single">// sparse by rows
</span><span class="whitespace">                </span><span class="name">st</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'R'</span><span class="punctuation">;</span><span class="whitespace">
                </span><span class="comment single">// import the control parameters and structural data
</span><span class="whitespace">                </span><span class="name">trek_import</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">control</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                             </span><span class="literal string">&quot;sparse_by_rows&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_col</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_ptr</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                  </span><span class="name">trek_s_import</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                 </span><span class="literal string">&quot;sparse_by_rows&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_col</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_ptr</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                </span><span class="punctuation">}</span><span class="whitespace">
                </span><span class="keyword">break</span><span class="punctuation">;</span><span class="whitespace">
            </span><span class="keyword">case</span><span class="whitespace"> </span><span class="literal number integer">3</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="comment single">// dense
</span><span class="whitespace">                </span><span class="name">st</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'D'</span><span class="punctuation">;</span><span class="whitespace">
                </span><span class="comment single">// import the control parameters and structural data
</span><span class="whitespace">                </span><span class="name">trek_import</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">control</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                            </span><span class="literal string">&quot;dense&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                  </span><span class="name">trek_s_import</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                 </span><span class="literal string">&quot;dense&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                </span><span class="punctuation">}</span><span class="whitespace">
                </span><span class="keyword">break</span><span class="punctuation">;</span><span class="whitespace">
            </span><span class="keyword">case</span><span class="whitespace"> </span><span class="literal number integer">4</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="comment single">// diagonal
</span><span class="whitespace">                </span><span class="name">st</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'G'</span><span class="punctuation">;</span><span class="whitespace">
                </span><span class="comment single">// import the control parameters and structural data
</span><span class="whitespace">                </span><span class="name">trek_import</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">control</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                             </span><span class="literal string">&quot;diagonal&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                  </span><span class="name">trek_s_import</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                 </span><span class="literal string">&quot;diagonal&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                </span><span class="punctuation">}</span><span class="whitespace">
                </span><span class="keyword">break</span><span class="punctuation">;</span><span class="whitespace">
            </span><span class="punctuation">}</span><span class="whitespace">
        </span><span class="keyword">for</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">r_is</span><span class="operator">=</span><span class="literal number integer">1</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">r_is</span><span class="whitespace"> </span><span class="operator">&lt;=</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">r_is</span><span class="operator">++</span><span class="punctuation">){</span><span class="whitespace"> </span><span class="comment single">// original or smaller radius
</span><span class="whitespace">
          </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">r_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="comment single">// use the original radius
</span><span class="whitespace">             </span><span class="name">radius</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number float">1.0</span><span class="punctuation">;</span><span class="whitespace">
          </span><span class="punctuation">}</span><span class="whitespace">
          </span><span class="keyword">else</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="comment single">// use the smaller radius
</span><span class="whitespace">             </span><span class="name">radius</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">inform</span><span class="punctuation">.</span><span class="name">next_radius</span><span class="punctuation">;</span><span class="whitespace">
             </span><span class="name">control</span><span class="punctuation">.</span><span class="name">new_radius</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name builtin">true</span><span class="punctuation">;</span><span class="whitespace">
             </span><span class="name">trek_reset_control</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">control</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
          </span><span class="punctuation">}</span><span class="whitespace">

          </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">r_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="whitespace"> </span><span class="operator">&amp;&amp;</span><span class="whitespace"> </span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="whitespace"> </span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
            </span><span class="name">strcpy</span><span class="punctuation">(</span><span class="name">sr</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal string">&quot;S-&quot;</span><span class="punctuation">);</span><span class="whitespace">
          </span><span class="punctuation">}</span><span class="whitespace">
          </span><span class="keyword">else</span><span class="whitespace"> </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">r_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
            </span><span class="name">strcpy</span><span class="punctuation">(</span><span class="name">sr</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal string">&quot;- &quot;</span><span class="punctuation">);</span><span class="whitespace">
          </span><span class="punctuation">}</span><span class="whitespace">
          </span><span class="keyword">else</span><span class="whitespace"> </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
            </span><span class="name">strcpy</span><span class="punctuation">(</span><span class="name">sr</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal string">&quot;S &quot;</span><span class="punctuation">);</span><span class="whitespace">
          </span><span class="punctuation">}</span><span class="whitespace">
          </span><span class="keyword">else</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
            </span><span class="name">strcpy</span><span class="punctuation">(</span><span class="name">sr</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal string">&quot;  &quot;</span><span class="punctuation">);</span><span class="whitespace">
          </span><span class="punctuation">}</span><span class="whitespace">
          </span><span class="comment single">// solve the problem
</span><span class="whitespace">          </span><span class="keyword">switch</span><span class="punctuation">(</span><span class="name">storage_type</span><span class="punctuation">){</span><span class="whitespace">
              </span><span class="keyword">case</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="comment single">// sparse co-ordinate storage
</span><span class="whitespace">                  </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                    </span><span class="name">trek_solve_problem</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">H_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_val</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">c</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">radius</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">x</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">S_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_val</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                  </span><span class="punctuation">}</span><span class="whitespace">
                  </span><span class="keyword">else</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                    </span><span class="name">trek_solve_problem</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">H_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_val</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">c</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">radius</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">x</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                  </span><span class="punctuation">}</span><span class="whitespace">
                  </span><span class="keyword">break</span><span class="punctuation">;</span><span class="whitespace">
              </span><span class="keyword">case</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="comment single">// sparse by rows
</span><span class="whitespace">                  </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                    </span><span class="name">trek_solve_problem</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">H_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_val</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">c</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">radius</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">x</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">S_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_val</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                  </span><span class="punctuation">}</span><span class="whitespace">
                  </span><span class="keyword">else</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                    </span><span class="name">trek_solve_problem</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">H_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_val</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">c</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">radius</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">x</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                  </span><span class="punctuation">}</span><span class="whitespace">
                  </span><span class="keyword">break</span><span class="punctuation">;</span><span class="whitespace">
              </span><span class="keyword">case</span><span class="whitespace"> </span><span class="literal number integer">3</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="comment single">// dense
</span><span class="whitespace">                  </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                    </span><span class="name">trek_solve_problem</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">H_dense_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_dense</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">c</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">radius</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">x</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">S_dense_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_dense</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                  </span><span class="punctuation">}</span><span class="whitespace">
                  </span><span class="keyword">else</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                    </span><span class="name">trek_solve_problem</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">H_dense_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_dense</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">c</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">radius</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">x</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                  </span><span class="punctuation">}</span><span class="whitespace">
                  </span><span class="keyword">break</span><span class="punctuation">;</span><span class="whitespace">
              </span><span class="keyword">case</span><span class="whitespace"> </span><span class="literal number integer">4</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="comment single">// diagonal
</span><span class="whitespace">                  </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                    </span><span class="name">trek_solve_problem</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_diag</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">c</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">radius</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">x</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_diag</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                  </span><span class="punctuation">}</span><span class="whitespace">
                  </span><span class="keyword">else</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                    </span><span class="name">trek_solve_problem</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_diag</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">c</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">radius</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">x</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                  </span><span class="punctuation">}</span><span class="whitespace">
                  </span><span class="keyword">break</span><span class="punctuation">;</span><span class="whitespace">
              </span><span class="punctuation">}</span><span class="whitespace">

          </span><span class="name">trek_information</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">inform</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
</span><span class="comment preproc">#ifdef REAL_128
</span><span class="whitespace">          </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;format %c%s: TREK_solve_problem exit status = %1&quot;</span><span class="whitespace"> </span><span class="name">d_ipc_</span><span class="whitespace">
                 </span><span class="literal string">&quot;, f = %.2f</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">st</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">sr</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">inform</span><span class="punctuation">.</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="keyword type">double</span><span class="punctuation">)</span><span class="name">inform</span><span class="punctuation">.</span><span class="name">obj</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
</span><span class="comment preproc">#else
</span><span class="whitespace">          </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;format %c%s: TREK_solve_problem exit status = %1&quot;</span><span class="whitespace"> </span><span class="name">d_ipc_</span><span class="whitespace">
                 </span><span class="literal string">&quot;, f = %.2f</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">st</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">sr</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">inform</span><span class="punctuation">.</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">inform</span><span class="punctuation">.</span><span class="name">obj</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
</span><span class="comment preproc">#endif
</span><span class="whitespace">          </span><span class="comment single">//printf(&quot;x: &quot;);
</span><span class="whitespace">          </span><span class="comment single">//for( ipc_ i = 0; i &lt; n+m; i++) printf(&quot;%f &quot;, x[i]);
</span><span class="whitespace">
        </span><span class="punctuation">}</span><span class="whitespace">
        </span><span class="comment single">// Delete internal workspace
</span><span class="whitespace">        </span><span class="name">trek_terminate</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">control</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">inform</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">

      </span><span class="punctuation">}</span><span class="whitespace">
    </span><span class="punctuation">}</span><span class="whitespace">
  </span><span class="punctuation">}</span></code></pre>
<p>This is the same example, but now fortran-style indexing is used;
the code is available in $GALAHAD/src/trek/C/trektf.c .</p>
<pre class="code C literal-block"><code><span class="comment multiline">/* trektf.c */</span><span class="whitespace">
</span><span class="comment multiline">/* Full test for the TREK C interface using Fortran sparse matrix indexing */</span><span class="whitespace">

</span><span class="comment preproc">#include</span><span class="whitespace"> </span><span class="comment preprocfile">&lt;stdio.h&gt;</span><span class="comment preproc">
#include</span><span class="whitespace"> </span><span class="comment preprocfile">&lt;string.h&gt;</span><span class="comment preproc">
#include</span><span class="whitespace"> </span><span class="comment preprocfile">&lt;math.h&gt;</span><span class="comment preproc">
#include</span><span class="whitespace"> </span><span class="comment preprocfile">&quot;galahad_precision.h&quot;</span><span class="comment preproc">
#include</span><span class="whitespace"> </span><span class="comment preprocfile">&quot;galahad_cfunctions.h&quot;</span><span class="comment preproc">
#include</span><span class="whitespace"> </span><span class="comment preprocfile">&quot;galahad_trek.h&quot;</span><span class="comment preproc">
#ifdef REAL_128
#include</span><span class="whitespace"> </span><span class="comment preprocfile">&lt;quadmath.h&gt;</span><span class="comment preproc">
#endif
</span><span class="whitespace">
</span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name function">main</span><span class="punctuation">(</span><span class="keyword type">void</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">

    </span><span class="comment single">// Derived types
</span><span class="whitespace">    </span><span class="keyword type">void</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">data</span><span class="punctuation">;</span><span class="whitespace">
    </span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">trek_control_type</span><span class="whitespace"> </span><span class="name">control</span><span class="punctuation">;</span><span class="whitespace">
    </span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">trek_inform_type</span><span class="whitespace"> </span><span class="name">inform</span><span class="punctuation">;</span><span class="whitespace">

    </span><span class="comment single">// Set problem data
</span><span class="whitespace">    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">n</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">3</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="comment single">// dimension of H
</span><span class="whitespace">    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">H_ne</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">4</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="comment single">// number of elements of H
</span><span class="whitespace">    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">S_ne</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">3</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="comment single">// number of elements of M
</span><span class="whitespace">    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">H_dense_ne</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">6</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="comment single">// number of elements of H
</span><span class="whitespace">    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">S_dense_ne</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">6</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="comment single">// number of elements of M
</span><span class="whitespace">    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">H_row</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number integer">1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">3</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">3</span><span class="punctuation">};</span><span class="whitespace"> </span><span class="comment single">// row indices, NB lower triangle
</span><span class="whitespace">    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">H_col</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number integer">1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">3</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">H_ptr</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number integer">1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">3</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">5</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">S_row</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number integer">1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">3</span><span class="punctuation">};</span><span class="whitespace"> </span><span class="comment single">// row indices, NB lower triangle
</span><span class="whitespace">    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">S_col</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number integer">1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">3</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">S_ptr</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number integer">1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">3</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">4</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">rpc_</span><span class="whitespace"> </span><span class="name">H_val</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number float">1.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">2.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">3.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">4.0</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">rpc_</span><span class="whitespace"> </span><span class="name">S_val</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number float">1.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">2.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">1.0</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">rpc_</span><span class="whitespace"> </span><span class="name">H_dense</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number float">1.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">0.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">2.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">4.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">0.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">3.0</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">rpc_</span><span class="whitespace"> </span><span class="name">S_dense</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number float">1.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">0.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">2.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">0.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">0.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">1.0</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">rpc_</span><span class="whitespace"> </span><span class="name">H_diag</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number float">1.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">0.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">2.0</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">rpc_</span><span class="whitespace"> </span><span class="name">S_diag</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number float">1.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">2.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">1.0</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="name">rpc_</span><span class="whitespace"> </span><span class="name">radius</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number float">1.0</span><span class="punctuation">;</span><span class="whitespace">
    </span><span class="name">rpc_</span><span class="whitespace"> </span><span class="name">c</span><span class="punctuation">[]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="literal number float">0.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">2.0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number float">0.0</span><span class="punctuation">};</span><span class="whitespace">
    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="name">st</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">' '</span><span class="punctuation">;</span><span class="whitespace">
    </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">status</span><span class="punctuation">;</span><span class="whitespace">
    </span><span class="name">rpc_</span><span class="whitespace"> </span><span class="name">x</span><span class="punctuation">[</span><span class="name">n</span><span class="punctuation">];</span><span class="whitespace">
    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="name">sr</span><span class="punctuation">[</span><span class="literal number integer">3</span><span class="punctuation">];</span><span class="whitespace">

    </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot; Fortran sparse matrix indexing</span><span class="literal string escape">\n\n</span><span class="literal string">&quot;</span><span class="punctuation">);</span><span class="whitespace">

    </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot; basic tests of storage formats</span><span class="literal string escape">\n\n</span><span class="literal string">&quot;</span><span class="punctuation">);</span><span class="whitespace">

    </span><span class="keyword">for</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">s_is</span><span class="operator">=</span><span class="literal number integer">0</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">&lt;=</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">s_is</span><span class="operator">++</span><span class="punctuation">){</span><span class="whitespace"> </span><span class="comment single">// include a scaling matrix?
</span><span class="whitespace">      </span><span class="keyword">for</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">storage_type</span><span class="operator">=</span><span class="literal number integer">1</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">storage_type</span><span class="whitespace"> </span><span class="operator">&lt;=</span><span class="whitespace"> </span><span class="literal number integer">4</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">storage_type</span><span class="operator">++</span><span class="punctuation">){</span><span class="whitespace">

        </span><span class="comment single">// Initialize TREK
</span><span class="whitespace">        </span><span class="name">trek_initialize</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">control</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">

        </span><span class="comment single">// Set user-defined control options
</span><span class="whitespace">        </span><span class="name">control</span><span class="punctuation">.</span><span class="name">f_indexing</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name builtin">true</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="comment single">// Fortran sparse matrix indexing
</span><span class="whitespace">
        </span><span class="keyword">switch</span><span class="punctuation">(</span><span class="name">storage_type</span><span class="punctuation">){</span><span class="whitespace">
            </span><span class="keyword">case</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="comment single">// sparse co-ordinate storage
</span><span class="whitespace">                </span><span class="name">st</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'C'</span><span class="punctuation">;</span><span class="whitespace">
                </span><span class="comment single">// import the control parameters and structural data
</span><span class="whitespace">                </span><span class="name">trek_import</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">control</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                             </span><span class="literal string">&quot;coordinate&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_row</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_col</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                  </span><span class="name">trek_s_import</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                </span><span class="literal string">&quot;coordinate&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_row</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_col</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                </span><span class="punctuation">}</span><span class="whitespace">
                </span><span class="keyword">break</span><span class="punctuation">;</span><span class="whitespace">
            </span><span class="keyword">case</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="comment single">// sparse by rows
</span><span class="whitespace">                </span><span class="name">st</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'R'</span><span class="punctuation">;</span><span class="whitespace">
                </span><span class="comment single">// import the control parameters and structural data
</span><span class="whitespace">                </span><span class="name">trek_import</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">control</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                             </span><span class="literal string">&quot;sparse_by_rows&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_col</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_ptr</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                  </span><span class="name">trek_s_import</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                 </span><span class="literal string">&quot;sparse_by_rows&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_col</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_ptr</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                </span><span class="punctuation">}</span><span class="whitespace">
                </span><span class="keyword">break</span><span class="punctuation">;</span><span class="whitespace">
            </span><span class="keyword">case</span><span class="whitespace"> </span><span class="literal number integer">3</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="comment single">// dense
</span><span class="whitespace">                </span><span class="name">st</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'D'</span><span class="punctuation">;</span><span class="whitespace">
                </span><span class="comment single">// import the control parameters and structural data
</span><span class="whitespace">                </span><span class="name">trek_import</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">control</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                            </span><span class="literal string">&quot;dense&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                  </span><span class="name">trek_s_import</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                 </span><span class="literal string">&quot;dense&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                </span><span class="punctuation">}</span><span class="whitespace">
                </span><span class="keyword">break</span><span class="punctuation">;</span><span class="whitespace">
            </span><span class="keyword">case</span><span class="whitespace"> </span><span class="literal number integer">4</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="comment single">// diagonal
</span><span class="whitespace">                </span><span class="name">st</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'G'</span><span class="punctuation">;</span><span class="whitespace">
                </span><span class="comment single">// import the control parameters and structural data
</span><span class="whitespace">                </span><span class="name">trek_import</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">control</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                             </span><span class="literal string">&quot;diagonal&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                  </span><span class="name">trek_s_import</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                 </span><span class="literal string">&quot;diagonal&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                </span><span class="punctuation">}</span><span class="whitespace">
                </span><span class="keyword">break</span><span class="punctuation">;</span><span class="whitespace">
            </span><span class="punctuation">}</span><span class="whitespace">
        </span><span class="keyword">for</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">ipc_</span><span class="whitespace"> </span><span class="name">r_is</span><span class="operator">=</span><span class="literal number integer">1</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">r_is</span><span class="whitespace"> </span><span class="operator">&lt;=</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">r_is</span><span class="operator">++</span><span class="punctuation">){</span><span class="whitespace"> </span><span class="comment single">// original or smaller radius
</span><span class="whitespace">
          </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">r_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="comment single">// use the original radius
</span><span class="whitespace">             </span><span class="name">radius</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number float">1.0</span><span class="punctuation">;</span><span class="whitespace">
          </span><span class="punctuation">}</span><span class="whitespace">
          </span><span class="keyword">else</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="comment single">// use the smaller radius
</span><span class="whitespace">             </span><span class="name">radius</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">inform</span><span class="punctuation">.</span><span class="name">next_radius</span><span class="punctuation">;</span><span class="whitespace">
             </span><span class="name">control</span><span class="punctuation">.</span><span class="name">new_radius</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name builtin">true</span><span class="punctuation">;</span><span class="whitespace">
             </span><span class="name">trek_reset_control</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">control</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
          </span><span class="punctuation">}</span><span class="whitespace">

          </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">r_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="whitespace"> </span><span class="operator">&amp;&amp;</span><span class="whitespace"> </span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="whitespace"> </span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
            </span><span class="name">strcpy</span><span class="punctuation">(</span><span class="name">sr</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal string">&quot;S+&quot;</span><span class="punctuation">);</span><span class="whitespace">
          </span><span class="punctuation">}</span><span class="whitespace">
          </span><span class="keyword">else</span><span class="whitespace"> </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">r_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
            </span><span class="name">strcpy</span><span class="punctuation">(</span><span class="name">sr</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal string">&quot;+ &quot;</span><span class="punctuation">);</span><span class="whitespace">
          </span><span class="punctuation">}</span><span class="whitespace">
          </span><span class="keyword">else</span><span class="whitespace"> </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
            </span><span class="name">strcpy</span><span class="punctuation">(</span><span class="name">sr</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal string">&quot;S &quot;</span><span class="punctuation">);</span><span class="whitespace">
          </span><span class="punctuation">}</span><span class="whitespace">
          </span><span class="keyword">else</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
            </span><span class="name">strcpy</span><span class="punctuation">(</span><span class="name">sr</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal string">&quot;  &quot;</span><span class="punctuation">);</span><span class="whitespace">
          </span><span class="punctuation">}</span><span class="whitespace">
          </span><span class="comment single">// solve the problem
</span><span class="whitespace">          </span><span class="keyword">switch</span><span class="punctuation">(</span><span class="name">storage_type</span><span class="punctuation">){</span><span class="whitespace">
              </span><span class="keyword">case</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="comment single">// sparse co-ordinate storage
</span><span class="whitespace">                  </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                    </span><span class="name">trek_solve_problem</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">H_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_val</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">c</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">radius</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">x</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">S_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_val</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                  </span><span class="punctuation">}</span><span class="whitespace">
                  </span><span class="keyword">else</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                    </span><span class="name">trek_solve_problem</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">H_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_val</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">c</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">radius</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">x</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                  </span><span class="punctuation">}</span><span class="whitespace">
                  </span><span class="keyword">break</span><span class="punctuation">;</span><span class="whitespace">
              </span><span class="keyword">case</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="comment single">// sparse by rows
</span><span class="whitespace">                  </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                    </span><span class="name">trek_solve_problem</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">H_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_val</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">c</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">radius</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">x</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">S_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_val</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                  </span><span class="punctuation">}</span><span class="whitespace">
                  </span><span class="keyword">else</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                    </span><span class="name">trek_solve_problem</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">H_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_val</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">c</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">radius</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">x</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                  </span><span class="punctuation">}</span><span class="whitespace">
                  </span><span class="keyword">break</span><span class="punctuation">;</span><span class="whitespace">
              </span><span class="keyword">case</span><span class="whitespace"> </span><span class="literal number integer">3</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="comment single">// dense
</span><span class="whitespace">                  </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                    </span><span class="name">trek_solve_problem</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">H_dense_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_dense</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">c</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">radius</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">x</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">S_dense_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_dense</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                  </span><span class="punctuation">}</span><span class="whitespace">
                  </span><span class="keyword">else</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                    </span><span class="name">trek_solve_problem</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">H_dense_ne</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_dense</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">c</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">radius</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">x</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                  </span><span class="punctuation">}</span><span class="whitespace">
                  </span><span class="keyword">break</span><span class="punctuation">;</span><span class="whitespace">
              </span><span class="keyword">case</span><span class="whitespace"> </span><span class="literal number integer">4</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="comment single">// diagonal
</span><span class="whitespace">                  </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">s_is</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                    </span><span class="name">trek_solve_problem</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_diag</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">c</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">radius</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">x</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">S_diag</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                  </span><span class="punctuation">}</span><span class="whitespace">
                  </span><span class="keyword">else</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
                    </span><span class="name">trek_solve_problem</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace">
                                        </span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">H_diag</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">c</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">radius</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">x</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
                  </span><span class="punctuation">}</span><span class="whitespace">
                  </span><span class="keyword">break</span><span class="punctuation">;</span><span class="whitespace">
              </span><span class="punctuation">}</span><span class="whitespace">

          </span><span class="name">trek_information</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">inform</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">status</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
</span><span class="comment preproc">#ifdef REAL_128
</span><span class="whitespace">          </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;format %c%s: TREK_solve_problem exit status = %1&quot;</span><span class="whitespace"> </span><span class="name">d_ipc_</span><span class="whitespace">
                 </span><span class="literal string">&quot;, f = %.2f</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">st</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">sr</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">inform</span><span class="punctuation">.</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="keyword type">double</span><span class="punctuation">)</span><span class="name">inform</span><span class="punctuation">.</span><span class="name">obj</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
</span><span class="comment preproc">#else
</span><span class="whitespace">          </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;format %c%s: TREK_solve_problem exit status = %1&quot;</span><span class="whitespace"> </span><span class="name">d_ipc_</span><span class="whitespace">
                 </span><span class="literal string">&quot;, f = %.2f</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">st</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">sr</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">inform</span><span class="punctuation">.</span><span class="name">status</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">inform</span><span class="punctuation">.</span><span class="name">obj</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
</span><span class="comment preproc">#endif
</span><span class="whitespace">          </span><span class="comment single">//printf(&quot;x: &quot;);
</span><span class="whitespace">          </span><span class="comment single">//for( ipc_ i = 0; i &lt; n+m; i++) printf(&quot;%f &quot;, x[i]);
</span><span class="whitespace">
        </span><span class="punctuation">}</span><span class="whitespace">
        </span><span class="comment single">// Delete internal workspace
</span><span class="whitespace">        </span><span class="name">trek_terminate</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">data</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">control</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">inform</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">

      </span><span class="punctuation">}</span><span class="whitespace">
    </span><span class="punctuation">}</span><span class="whitespace">
  </span><span class="punctuation">}</span></code></pre>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="struct_rqs_inform_type.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">rqs_inform_type structure</p>
      </div>
    </a>
    <a class="right-next"
       href="trek_functions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">overview of functions provided</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#purpose">purpose</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#method">method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reference">reference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-storage">matrix storage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-function-calls">introduction to function calls</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#callable-functions">callable functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-functions-provided">overview of functions provided</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#typedefs">typedefs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#function-and-structure-names">function and structure names</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#function-calls">function calls</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#available-structures">available structures</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trek-control-type-structure">trek_control_type structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detailed-documentation">detailed documentation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#components">components</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trek-time-type-structure">trek_time_type structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#details-structtrek-time-type">detailed documentation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">components</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trek-inform-type-structure">trek_inform_type structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#details-structtrek-inform-type">detailed documentation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">components</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-calls">example calls</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="_sources/trek.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright Gould/Orban/Toint, for GALAHAD productions, GALAHAD 4 C/Python interfaces copyright Fowkes/Gould.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>